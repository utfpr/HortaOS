function unbindBeforeUnloadEvents(){$(window).unbind("beforeunload.channel"),$(document).unbind("page:before-change.channel page:before-unload.channel")}function confirmUnsavedChanges(){var e=$("#unsaved_message").val(),t=channelInfo();unbindBeforeUnloadEvents(),$(window).bind("beforeunload.channel",function(){return channelChanged(t)?e:void 0}),$(document).bind("page:before-change.channel page:before-unload.channel",function(){return channelChanged(t)&&!confirm(e)?!1:void 0})}function channelInfo(){var e=$(":text").get(),t=$(":radio:checked").get(),n=$(":checkbox").get(),i=$("textarea").get(),r=[e,i,t,n].map(function(e){return e.map(function(e){return e.value})});return r.reduce(function(e,t){return e.concat(t)})}function channelChanged(e){if(!elementPresent($("#channel_form")))return!1;if("/channels/new"===window.location.pathname)return!0;var t=channelInfo();if(e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(t[n]!==e[n])return!0;return!1}function setSchedulable(){switch($("#schedulable_templates").append($(".schedulable_template")),$("#schedulable").html(""),$("#timecontrol_schedulable_type").val()){case"TwitterAccount":$("#schedulable").append($("#thingtweet_template")),disableDateTime(!1);break;case"Thinghttp":$("#schedulable").append($("#thinghttp_template")),disableDateTime(!1);break;case"Talkback":$("#schedulable").append($("#talkback_template")),disableDateTime(!1);break;case"MatlabCode":$("#schedulable").append($("#matlab_code_template")),disableDateTime($("#timecontrol_frequency_hourly").prop("checked")===!0||$("#timecontrol_frequency_minutes").prop("checked")===!0?!0:!1);break;case"MatlabIotAnalytic":$("#schedulable").append($("#matlab_iot_analytic_template")),disableDateTime($("#timecontrol_frequency_hourly").prop("checked")===!0||$("#timecontrol_frequency_minutes").prop("checked")===!0?!0:!1)}}function setWeekdays(){var e=$("#saved_weekdays").val();e.length>0&&$.each(e.split(" "),function(e,t){$('.weekdays[value="'+t+'"]').prop("checked",!0)})}function fixDateTime(){var e=$("#timecontrol_run_at").val(),t=$("#saved_hour").val();if(e.length>0){var n=e.split(" ");$("#timecontrol_run_at").val(n[0])}if(t.length>0){var i=t.split(" ");$("#hour").val(i[0]),$("#minute").val($("#saved_minute").val()),$("#ampm").val(i[1])}}function getStartTime(){$.ajax({url:"calculate_start_time",success:function(e){var t=e.start_time;$("#hour").val(parseInt(t.substring(0,2),10)),$("#minute").val(t.substring(3,5)),$("#second").val(t.substring(6,8)),$("#ampm").val(t.substring(9).toLowerCase()),$("#minute_start_time").text($("#hour").val()+":"+$("#minute").val()+" "+$("#ampm").val())}})}function disableDateTime(e){e?(getStartTime(),$("#frequency_div_time").hide(),$("#frequency_div_start_time").show()):($("#frequency_div_time").show(),$("#frequency_div_start_time").hide())}function recurrancyHandler(){$("#timecontrol_frequency_weekly").prop("checked")===!0?($("#frequency_once_div").hide(),$("#frequency_recurring_div_days").show(),$("#frequency_recurring_div_hours").hide(),$("#frequency_recurring_div_minutes").hide(),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").show(),setTimeLabel("Time"),disableDateTime(!1)):$("#timecontrol_frequency_daily").prop("checked")===!0?($("#frequency_once_div").hide(),$("#frequency_recurring_div_hours").hide(),$("#frequency_recurring_div_minutes").hide(),$("#frequency_recurring_div_days").hide(),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").show(),setTimeLabel("Time"),disableDateTime(!1)):$("#timecontrol_frequency_hourly").prop("checked")===!0?($("#frequency_once_div").hide(),$("#frequency_recurring_div_days").hide(),$("#frequency_recurring_div_minutes").hide(),$("#frequency_recurring_div_hours").show(),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").show(),disableDateTime("MatlabCode"===$("#timecontrol_schedulable_type").val()||"MatlabIotAnalytic"===$("#timecontrol_schedulable_type").val()?!0:!1),setTimeLabel("Start Time")):$("#timecontrol_frequency_minutes").prop("checked")===!0&&($("#frequency_once_div").hide(),$("#frequency_recurring_div_days").hide(),$("#frequency_recurring_div_hours").hide(),$("#frequency_recurring_div_minutes").show(),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").show(),disableDateTime("MatlabCode"===$("#timecontrol_schedulable_type").val()||"MatlabIotAnalytic"===$("#timecontrol_schedulable_type").val()?!0:!1),setTimeLabel("Start Time")),displayFuzzyTimeOptions()}function setTimeLabel(e){$("#time_label").text(e)}function setWeekdays(){var e=$("#saved_weekdays").val();e.length>0&&$.each(e.split(" "),function(e,t){$('.weekdays[value="'+t+'"]').prop("checked",!0)})}function setFrequencyOption(){$("#timecontrol_frequency_weekly").prop("checked")===!0||$("#timecontrol_frequency_daily").prop("checked")===!0||$("#timecontrol_frequency_hourly").prop("checked")===!0||$("#timecontrol_frequency_minutes").prop("checked")===!0?$("#frequency_recurrance").attr("checked",!0):$("#frequency_once").attr("checked",!0),frequencyHandler()}function frequencyHandler(){$("#frequency_once").prop("checked")===!0?($("#frequency_recurring_div").hide(),$("#frequency_once_div").show(),$("#frequency_recurring_div_choice").hide(),$("#frequency_once_div_date").show(),$("#frequency_recurring_div_hours").hide(),$("#frequency_recurring_div_minutes").hide(),$("#frequency_recurring_div_days").hide(),setTimeLabel("Time"),disableDateTime(!1)):$("#frequency_recurrance").prop("checked")===!0&&($("#frequency_once_div").hide(),$("#frequency_recurring_div").show(),$("#frequency_once_div_date").hide(),$("#frequency_recurring_div_choice").show(),$("input:radio[class='recurrance_radio']").is(":checked")||$("#timecontrol_frequency_weekly").attr("checked",!0),recurrancyHandler())}function displayFuzzyTimeOptions(){if($("#timecontrol_frequency_minutes").prop("checked")===!0&&$("#frequency_once").prop("checked")===!1){recurring_minute=$("#timecontrol_recurring_minute").prop("selectedOptions")[0];var e=recurring_minute.value/2;e=60*e,$("#fuzzy_time option").each(function(){$(this).val()<e?$(this).show():$(this).hide()}),$("#fuzzy_time").val($("#fuzzy_time option:first").val())}else $("#fuzzy_time option").each(function(){$(this).show()})}!function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var n,i=e(document);e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,i){var r=e.Event(n);return t.trigger(r,i),r.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(i){var r,a,s,o,l,u,h,c;if(n.fire(i,"ajax:before")){if(o=i.data("cross-domain"),l=o===t?null:o,u=i.data("with-credentials")||null,h=i.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,i.is("form")){r=i.attr("method"),a=i.attr("action"),s=i.serializeArray();var d=i.data("ujs:submit-button");d&&(s.push(d),i.data("ujs:submit-button",null))}else i.is(n.inputChangeSelector)?(r=i.data("method"),a=i.data("url"),s=i.serialize(),i.data("params")&&(s=s+"&"+i.data("params"))):i.is(n.buttonClickSelector)?(r=i.data("method")||"get",a=i.data("url"),s=i.serialize(),i.data("params")&&(s=s+"&"+i.data("params"))):(r=i.data("method"),a=n.href(i),s=i.data("params")||null);c={type:r||"GET",data:s,dataType:h,beforeSend:function(e,r){return r.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+r.accepts.script),n.fire(i,"ajax:beforeSend",[e,r])},success:function(e,t,n){i.trigger("ajax:success",[e,t,n])},complete:function(e,t){i.trigger("ajax:complete",[e,t])},error:function(e,t,n){i.trigger("ajax:error",[e,t,n])},crossDomain:l},u&&(c.xhrFields={withCredentials:u}),a&&(c.url=a);var f=n.ajax(c);return i.trigger("ajax:send",f),f}return!1},handleMethod:function(i){var r=n.href(i),a=i.data("method"),s=i.attr("target"),o=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),u=e('<form method="post" action="'+r+'"></form>'),h='<input name="_method" value="'+a+'" type="hidden" />';l!==t&&o!==t&&(h+='<input name="'+l+'" value="'+o+'" type="hidden" />'),s&&u.attr("target",s),u.hide().append(h).appendTo("body"),u.submit()},disableFormElements:function(t){t.find(n.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(n.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,i=e.data("confirm"),r=!1;return i?(n.fire(e,"confirm")&&(r=n.confirm(i),t=n.fire(e,"confirm:complete",[r])),r&&t):!0},blankInputs:function(t,n,i){var r,a,s=e(),o=n||"input,textarea",l=t.find(o);return l.each(function(){if(r=e(this),a=r.is("input[type=checkbox],input[type=radio]")?r.is(":checked"):r.val(),!a==!i){if(r.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+r.attr("name")+'"]').length)return!0;s=s.add(r)}}),s.length?s:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return n.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},n.fire(i,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,i){e.crossDomain||n.CSRFProtection(i)}),i.delegate(n.linkDisableSelector,"ajax:complete",function(){n.enableElement(e(this))}),i.delegate(n.linkClickSelector,"click.rails",function(i){var r=e(this),a=r.data("method"),s=r.data("params");if(!n.allowAction(r))return n.stopEverything(i);if(r.is(n.linkDisableSelector)&&n.disableElement(r),r.data("remote")!==t){if(!(!i.metaKey&&!i.ctrlKey||a&&"GET"!==a||s))return!0;var o=n.handleRemote(r);return o===!1?n.enableElement(r):o.error(function(){n.enableElement(r)}),!1}return r.data("method")?(n.handleMethod(r),!1):void 0}),i.delegate(n.buttonClickSelector,"click.rails",function(t){var i=e(this);return n.allowAction(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),i.delegate(n.inputChangeSelector,"change.rails",function(t){var i=e(this);return n.allowAction(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),i.delegate(n.formSubmitSelector,"submit.rails",function(i){var r=e(this),a=r.data("remote")!==t,s=n.blankInputs(r,n.requiredInputSelector),o=n.nonBlankInputs(r,n.fileInputSelector);if(!n.allowAction(r))return n.stopEverything(i);if(s&&r.attr("novalidate")==t&&n.fire(r,"ajax:aborted:required",[s]))return n.stopEverything(i);if(a){if(o){setTimeout(function(){n.disableFormElements(r)},13);var l=n.fire(r,"ajax:aborted:file",[o]);return l||setTimeout(function(){n.enableFormElements(r)},13),l}return n.handleRemote(r),!1}setTimeout(function(){n.disableFormElements(r)},13)}),i.delegate(n.formInputClickSelector,"click.rails",function(t){var i=e(this);if(!n.allowAction(i))return n.stopEverything(t);var r=i.attr("name"),a=r?{name:r,value:i.val()}:null;i.closest("form").data("ujs:submit-button",a)}),i.delegate(n.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&n.disableFormElements(e(this))}),i.delegate(n.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&n.enableFormElements(e(this))}),e(function(){var t=e("meta[name=csrf-token]").attr("content"),n=e("meta[name=csrf-param]").attr("content");e('form input[name="'+n+'"]').val(t)}))}(jQuery),function(e){e.cookie=function(t,n,i){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||null===n||void 0===n)){if(i=e.extend({},i),(null===n||void 0===n)&&(i.expires=-1),"number"==typeof i.expires){var r=i.expires,a=i.expires=new Date;a.setDate(a.getDate()+r)}return n=String(n),document.cookie=[encodeURIComponent(t),"=",i.raw?n:encodeURIComponent(n),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}i=n||{};for(var s,o=i.raw?function(e){return e}:decodeURIComponent,l=document.cookie.split("; "),u=0;s=l[u]&&l[u].split("=");u++)if(o(s[0])===t)return o(s[1]||"");return null}}(jQuery),function(){var e,t,n,i,r,a,s,o,l,u,h,c,d,f,p,m,g,v,_,y,b,w,T,$,x,S,E,D,k,R,C,A,M,O,U,I,N,L,P,q,B,F,V,j,H,K,J,z,Y,G,W,X,Q,Z,et,tt,nt=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},it=function(e,t){function n(){this.constructor=e}for(var i in t)rt.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},rt={}.hasOwnProperty,at=[].slice,st=function(e,t){return function(){return e.apply(t,arguments)}};O={},d=10,X=!1,P=null,_=null,A=null,F=null,tt=null,i={BEFORE_CHANGE:"page:before-change",FETCH:"page:fetch",RECEIVE:"page:receive",CHANGE:"page:change",UPDATE:"page:update",LOAD:"page:load",RESTORE:"page:restore",BEFORE_UNLOAD:"page:before-unload",EXPIRE:"page:expire"},$=function(e){var t;return e=new n(e),J(),c(),null!=P&&P.start(),X&&(t=Q(e.absolute))?(x(t),S(e,null,!1)):S(e,G)},Q=function(e){var t;return t=O[e],t&&!t.transitionCacheDisabled?t:void 0},b=function(e){return null==e&&(e=!0),X=e},y=function(e){return null==e&&(e=!0),u?e?null!=P?P:P=new a("html"):(null!=P&&P.uninstall(),P=null):void 0},S=function(e,t,n){return null==n&&(n=!0),Z(i.FETCH,{url:e.absolute}),null!=tt&&tt.abort(),tt=new XMLHttpRequest,tt.open("GET",e.withoutHashForIE10compatibility(),!0),tt.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),tt.setRequestHeader("X-XHR-Referer",F),tt.onload=function(){var n;return Z(i.RECEIVE,{url:e.absolute}),(n=L())?(V(e),j(),f.apply(null,T(n)),M(),"function"==typeof t&&t(),Z(i.LOAD)):document.location.href=v()||e.absolute},P&&n&&(tt.onprogress=function(){return function(e){var t;return t=e.lengthComputable?e.loaded/e.total*100:P.value+(100-P.value)/10,P.advanceTo(t)}}(this)),tt.onloadend=function(){return tt=null},tt.onerror=function(){return document.location.href=e.absolute},tt.send()},x=function(e){return null!=tt&&tt.abort(),f(e.title,e.body),q(e),Z(i.RESTORE)},c=function(){var e;return e=new n(_.url),O[e.absolute]={url:e.relative,body:document.body,title:document.title,positionY:window.pageYOffset,positionX:window.pageXOffset,cachedAt:(new Date).getTime(),transitionCacheDisabled:null!=document.querySelector("[data-no-transition-cache]")},m(d)},I=function(e){return null==e&&(e=d),/^[\d]+$/.test(e)?d=parseInt(e):void 0},m=function(e){var t,n,r,a,s,o;for(s=Object.keys(O),t=s.map(function(e){return O[e].cachedAt}).sort(function(e,t){return t-e}),o=[],n=0,a=s.length;a>n;n++)r=s[n],O[r].cachedAt<=t[e]&&(Z(i.EXPIRE,O[r]),o.push(delete O[r]));return o},f=function(t,n,r,a){return Z(i.BEFORE_UNLOAD),document.title=t,document.documentElement.replaceChild(n,document.body),null!=r&&e.update(r),W(),a&&w(),_=window.history.state,null!=P&&P.done(),Z(i.CHANGE),Z(i.UPDATE)},w=function(){var e,t,n,i,r,a,s,o,l,u,h,c;for(c=Array.prototype.slice.call(document.body.querySelectorAll('script:not([data-turbolinks-eval="false"])')),n=0,r=c.length;r>n;n++)if(h=c[n],""===(l=h.type)||"text/javascript"===l){for(t=document.createElement("script"),u=h.attributes,i=0,a=u.length;a>i;i++)e=u[i],t.setAttribute(e.name,e.value);h.hasAttribute("async")||(t.async=!1),t.appendChild(document.createTextNode(h.innerHTML)),o=h.parentNode,s=h.nextSibling,o.removeChild(h),o.insertBefore(t,s)}},z=function(e){return e.innerHTML=e.innerHTML.replace(/<noscript[\S\s]*?<\/noscript>/gi,""),e},W=function(){var e,t;return e=(t=document.querySelectorAll("input[autofocus], textarea[autofocus]"))[t.length-1],e&&document.activeElement!==e?e.focus():void 0},V=function(e){return(e=new n(e)).absolute!==F?window.history.pushState({turbolinks:!0,url:e.absolute},"",e.absolute):void 0},j=function(){var e,t;return(e=tt.getResponseHeader("X-XHR-Redirected-To"))?(e=new n(e),t=e.hasNoHash()?document.location.hash:"",window.history.replaceState(window.history.state,"",e.href+t)):void 0},v=function(){var e;return null!=(e=tt.getResponseHeader("Location"))&&new n(e).crossOrigin()?e:void 0},J=function(){return F=document.location.href},K=function(){return window.history.replaceState({turbolinks:!0,url:document.location.href},"",document.location.href)},H=function(){return _=window.history.state},M=function(){var e;return navigator.userAgent.match(/Firefox/)&&!(e=new n).hasNoHash()?(window.history.replaceState(_,"",e.withoutHash()),document.location.hash=e.hash):void 0},q=function(e){return window.scrollTo(e.positionX,e.positionY)},G=function(){return document.location.hash?document.location.href=document.location.href:window.scrollTo(0,0)},p=function(e){var t,n,i;if(null==e||"object"!=typeof e)return e;t=new e.constructor;for(n in e)i=e[n],t[n]=p(i);return t},N=function(e){var t,n;return n=(null!=(t=document.cookie.match(new RegExp(e+"=(\\w+)")))?t[1].toUpperCase():void 0)||"",document.cookie=e+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path=/",n},Z=function(e,t){var n;return"undefined"!=typeof Prototype&&Event.fire(document,e,t,!0),n=document.createEvent("Events"),t&&(n.data=t),n.initEvent(e,!0,!0),document.dispatchEvent(n)},U=function(e){return!Z(i.BEFORE_CHANGE,{url:e})},L=function(){var e,t,n,i,r,a;return t=function(){var e;return 400<=(e=tt.status)&&600>e},a=function(){var e;return null!=(e=tt.getResponseHeader("Content-Type"))&&e.match(/^(?:text\/html|application\/xhtml\+xml|application\/xml)(?:;|$)/)},i=function(e){var t,n,i,r,a;for(r=e.querySelector("head").childNodes,a=[],t=0,n=r.length;n>t;t++)i=r[t],null!=("function"==typeof i.getAttribute?i.getAttribute("data-turbolinks-track"):void 0)&&a.push(i.getAttribute("src")||i.getAttribute("href"));return a},e=function(e){var t;return A||(A=i(document)),t=i(e),t.length!==A.length||r(t,A).length!==A.length},r=function(e,t){var n,i,r,a,s;for(e.length>t.length&&(r=[t,e],e=r[0],t=r[1]),a=[],n=0,i=e.length;i>n;n++)s=e[n],nt.call(t,s)>=0&&a.push(s);return a},!t()&&a()&&(n=g(tt.responseText),n&&!e(n))?n:void 0},T=function(t){var n;return n=t.querySelector("title"),[null!=n?n.textContent:void 0,z(t.querySelector("body")),e.get(t).token,"runScripts"]},e={get:function(e){var t;return null==e&&(e=document),{node:t=e.querySelector('meta[name="csrf-token"]'),token:null!=t&&"function"==typeof t.getAttribute?t.getAttribute("content"):void 0}},update:function(e){var t;return t=this.get(),null!=t.token&&null!=e&&t.token!==e?t.node.setAttribute("content",e):void 0}},g=function(e){var t;return t=document.documentElement.cloneNode(),t.innerHTML=e,t.head=t.querySelector("head"),t.body=t.querySelector("body"),t},n=function(){function e(t){return this.original=null!=t?t:document.location.href,this.original.constructor===e?this.original:void this._parse()}return e.prototype.withoutHash=function(){return this.href.replace(this.hash,"").replace("#","")},e.prototype.withoutHashForIE10compatibility=function(){return this.withoutHash()},e.prototype.hasNoHash=function(){return 0===this.hash.length},e.prototype.crossOrigin=function(){return this.origin!==(new e).origin},e.prototype._parse=function(){var e;return(null!=this.link?this.link:this.link=document.createElement("a")).href=this.original,e=this.link,this.href=e.href,this.protocol=e.protocol,this.host=e.host,this.hostname=e.hostname,this.port=e.port,this.pathname=e.pathname,this.search=e.search,this.hash=e.hash,this.origin=[this.protocol,"//",this.hostname].join(""),0!==this.port.length&&(this.origin+=":"+this.port),this.relative=[this.pathname,this.search,this.hash].join(""),this.absolute=this.href},e}(),r=function(e){function t(e){return this.link=e,this.link.constructor===t?this.link:(this.original=this.link.href,this.originalElement=this.link,this.link=this.link.cloneNode(!1),void t.__super__.constructor.apply(this,arguments))}return it(t,e),t.HTML_EXTENSIONS=["html"],t.allowExtensions=function(){var e,n,i,r;for(n=1<=arguments.length?at.call(arguments,0):[],i=0,r=n.length;r>i;i++)e=n[i],t.HTML_EXTENSIONS.push(e);return t.HTML_EXTENSIONS},t.prototype.shouldIgnore=function(){return this.crossOrigin()||this._anchored()||this._nonHtml()||this._optOut()||this._target()},t.prototype._anchored=function(){return(this.hash.length>0||"#"===this.href.charAt(this.href.length-1))&&this.withoutHash()===(new n).withoutHash()},t.prototype._nonHtml=function(){return this.pathname.match(/\.[a-z]+$/g)&&!this.pathname.match(new RegExp("\\.(?:"+t.HTML_EXTENSIONS.join("|")+")?$","g"))},t.prototype._optOut=function(){var e,t;for(t=this.originalElement;!e&&t!==document;)e=null!=t.getAttribute("data-no-turbolink"),t=t.parentNode;return e},t.prototype._target=function(){return 0!==this.link.target.length},t}(n),t=function(){function e(e){this.event=e,this.event.defaultPrevented||(this._extractLink(),this._validForTurbolinks()&&(U(this.link.absolute)||et(this.link.href),this.event.preventDefault()))}return e.installHandlerLast=function(t){return t.defaultPrevented?void 0:(document.removeEventListener("click",e.handle,!1),document.addEventListener("click",e.handle,!1))},e.handle=function(t){return new e(t)},e.prototype._extractLink=function(){var e;for(e=this.event.target;e.parentNode&&"A"!==e.nodeName;)e=e.parentNode;return"A"===e.nodeName&&0!==e.href.length?this.link=new r(e):void 0},e.prototype._validForTurbolinks=function(){return null!=this.link&&!(this.link.shouldIgnore()||this._nonStandardClick())},e.prototype._nonStandardClick=function(){return this.event.which>1||this.event.metaKey||this.event.ctrlKey||this.event.shiftKey||this.event.altKey},e}(),a=function(){function e(e){this.elementSelector=e,this._trickle=st(this._trickle,this),this.value=0,this.content="",this.speed=300,this.opacity=.99,this.install()}var t;return t="turbolinks-progress-bar",e.prototype.install=function(){return this.element=document.querySelector(this.elementSelector),this.element.classList.add(t),this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement),this._updateStyle()},e.prototype.uninstall=function(){return this.element.classList.remove(t),document.head.removeChild(this.styleElement)},e.prototype.start=function(){return this.advanceTo(5)},e.prototype.advanceTo=function(e){var t;if(e>(t=this.value)&&100>=t){if(this.value=e,this._updateStyle(),100===this.value)return this._stopTrickle();if(this.value>0)return this._startTrickle()}},e.prototype.done=function(){return this.value>0?(this.advanceTo(100),this._reset()):void 0},e.prototype._reset=function(){var e;return e=this.opacity,setTimeout(function(e){return function(){return e.opacity=0,e._updateStyle()}}(this),this.speed/2),setTimeout(function(t){return function(){return t.value=0,t.opacity=e,t._withSpeed(0,function(){return t._updateStyle(!0)})}}(this),this.speed)},e.prototype._startTrickle=function(){return this.trickling?void 0:(this.trickling=!0,setTimeout(this._trickle,this.speed))},e.prototype._stopTrickle=function(){return delete this.trickling},e.prototype._trickle=function(){return this.trickling?(this.advanceTo(this.value+Math.random()/2),setTimeout(this._trickle,this.speed)):void 0},e.prototype._withSpeed=function(e,t){var n,i;return n=this.speed,this.speed=e,i=t(),this.speed=n,i},e.prototype._updateStyle=function(e){return null==e&&(e=!1),e&&this._changeContentToForceRepaint(),this.styleElement.textContent=this._createCSSRule()},e.prototype._changeContentToForceRepaint=function(){return this.content=""===this.content?" ":""},e.prototype._createCSSRule=function(){return this.elementSelector+"."+t+"::before {\n  content: '"+this.content+"';\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 2000;\n  background-color: #0076ff;\n  height: 3px;\n  opacity: "+this.opacity+";\n  width: "+this.value+"%;\n  transition: width "+this.speed+"ms ease-out, opacity "+this.speed/2+"ms ease-in;\n  transform: translate3d(0,0,0);\n}"},e}(),h=function(e){return setTimeout(e,500)},k=function(){return document.addEventListener("DOMContentLoaded",function(){return Z(i.CHANGE),Z(i.UPDATE)},!0)},C=function(){return"undefined"!=typeof jQuery?jQuery(document).on("ajaxSuccess",function(e,t){return jQuery.trim(t.responseText)?Z(i.UPDATE):void 0}):void 0},R=function(e){var t,i;return(null!=(i=e.state)?i.turbolinks:void 0)?(t=O[new n(e.state.url).absolute])?(c(),x(t)):et(e.target.location.href):void 0},D=function(){return K(),H(),document.addEventListener("click",t.installHandlerLast,!0),window.addEventListener("hashchange",function(){return K(),H()},!1),h(function(){return window.addEventListener("popstate",R,!1)})},E=void 0!==window.history.state||navigator.userAgent.match(/Firefox\/2[6|7]/),l=window.history&&window.history.pushState&&window.history.replaceState&&E,s=!navigator.userAgent.match(/CriOS\//),Y="GET"===(B=N("request_method"))||""===B,u=l&&s&&Y,o=document.addEventListener&&document.createEvent,o&&(k(),C()),u?(et=$,D()):et=function(e){return document.location.href=e},this.Turbolinks={visit:et,pagesCached:I,enableTransitionCache:b,enableProgressBar:y,allowLinkExtensions:r.allowExtensions,supported:u,EVENTS:p(i)}}.call(this),function(e){function t(){var t=n(this);return isNaN(t.datetime)||e(this).text(i(t.datetime)),this}function n(t){if(t=e(t),!t.data("timeago")){t.data("timeago",{datetime:a.datetime(t)});var n=e.trim(t.text());n.length>0&&t.attr("title",n)}return t.data("timeago")}function i(e){return a.inWords(r(e))}function r(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){return i(t instanceof Date?t:"string"==typeof t?e.timeago.parse(t):e.timeago.datetime(t))};var a=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(t){function n(n,r){var a=e.isFunction(n)?n(r,t):n,s=i.numbers&&i.numbers[r]||r;return a.replace(/%d/i,s)}var i=this.settings.strings,r=i.prefixAgo,a=i.suffixAgo;this.settings.allowFuture&&(0>t&&(r=i.prefixFromNow,a=i.suffixFromNow),t=Math.abs(t));var s=t/1e3,o=s/60,l=o/60,u=l/24,h=u/365,c=45>s&&n(i.seconds,Math.round(s))||90>s&&n(i.minute,1)||45>o&&n(i.minutes,Math.round(o))||90>o&&n(i.hour,1)||24>l&&n(i.hours,Math.round(l))||48>l&&n(i.day,1)||30>u&&n(i.days,Math.floor(u))||60>u&&n(i.month,1)||365>u&&n(i.months,Math.floor(u/30))||2>h&&n(i.year,1)||n(i.years,Math.floor(h));return e.trim([r,c,a].join(" "))},parse:function(t){var n=e.trim(t);return n=n.replace(/\.\d\d\d+/,""),n=n.replace(/-/,"/").replace(/-/,"/"),n=n.replace(/T/," ").replace(/Z/," UTC"),n=n.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)},datetime:function(t){var n="time"===e(t).get(0).tagName.toLowerCase(),i=e(t).attr(n?"datetime":"title");return a.parse(i)}}),e.fn.timeago=function(){var e=this;e.each(t);var n=a.settings;return n.refreshMillis>0&&setInterval(function(){e.each(t)},n.refreshMillis),e},document.createElement("abbr"),document.createElement("time")}(jQuery),function(e){window.NestedFormEvents=function(){this.addFields=e.proxy(this.addFields,this),this.removeFields=e.proxy(this.removeFields,this)},NestedFormEvents.prototype={addFields:function(t){var n=t.currentTarget,i=e(n).data("association"),r=e("#"+e(n).data("blueprint-id")),a=r.data("blueprint"),s=(e(n).closest(".fields").closestChild("input, textarea, select").eq(0).attr("name")||"").replace(new RegExp("[[a-z_]+]$"),"");if(s)for(var o=s.match(/[a-z_]+_attributes(?=\]\[(new_)?\d+\])/g)||[],l=s.match(/[0-9]+/g)||[],u=0;u<o.length;u++)l[u]&&(a=a.replace(new RegExp("(_"+o[u]+")_.+?_","g"),"$1_"+l[u]+"_"),a=a.replace(new RegExp("(\\["+o[u]+"\\])\\[.+?\\]","g"),"$1["+l[u]+"]"));var h=new RegExp("new_"+i,"g"),c=this.newId();a=e.trim(a.replace(h,c));var d=this.insertFields(a,i,n);return d.trigger({type:"nested:fieldAdded",field:d}).trigger({type:"nested:fieldAdded:"+i,field:d}),!1},newId:function(){return(new Date).getTime()},insertFields:function(t,n,i){var r=e(i).data("target");return r?e(t).appendTo(e(r)):e(t).insertBefore(i)},removeFields:function(t){var n=e(t.currentTarget),i=n.data("association"),r=n.prev("input[type=hidden]");r.val("1");var a=n.closest(".fields");return a.hide(),a.trigger({type:"nested:fieldRemoved",field:a}).trigger({type:"nested:fieldRemoved:"+i,field:a}),!1}},window.nestedFormEvents=new NestedFormEvents,e(document).delegate("form a.add_nested_fields","click",nestedFormEvents.addFields).delegate("form a.remove_nested_fields","click",nestedFormEvents.removeFields)}(jQuery),function(e){e.fn.closestChild=function(t){if(t&&""!=t){var n=[];for(n.push(this);n.length>0;)for(var i=n.shift(),r=i.children(),a=0;a<r.length;++a){var s=e(r[a]);if(s.is(t))return s;n.push(s)}}return e()}}(jQuery);var wloc=window.location.toString();-1!==wloc.indexOf("api")&&wloc.indexOf("api")<10&&-1===wloc.indexOf("charts")&&-1===wloc.indexOf("plugins")&&(window.location=wloc.replace("api","www")),function(e){function t(t,i,r,a){l={dataType:"json"},1===arguments.length&&"string"!=typeof arguments[0]?(l=e.extend(l,t),"url"in l&&"data"in l&&n(l.url,l.data)):(e.isFunction(i)&&(a=r,r=i,i=null),t=n(t,i),l=e.extend(l,{url:t,data:i,success:r,error:a}))}function n(e,t){var n,i,r;for(n in t)r=t[n],i=e.replace("{"+n+"}",r),i!=e&&(e=i,delete t[n]);return e}function i(t){return t.type=t.type||"GET","string"!=typeof t.data&&null!=t.data&&(t.data=e.param(t.data)),t.data=t.data||"",e.restSetup.csrf&&!e.isEmptyObject(e.restSetup.csrf)&&(/^(get)$/i.test(t.type)||/(authenticity_token=)/i.test(t.data)||(t.data+=(t.data?"&":"")+e.restSetup.csrfParam+"="+$restSetup.csrfToken)),/^(get|post)$/i.test(t.type)||(t.data+=(t.data?"&":"")+e.restSetup.methodParam+"="+t.type.toLowerCase(),t.type="POST"),u.call(this,t)}function r(){return t.apply(this,arguments),e.extend(l,{type:"GET"}),e.ajax(l)}function a(){return t.apply(this,arguments),e.extend(l,{type:"POST"}),e.ajax(l)}function s(){return t.apply(this,arguments),e.extend(l,{type:"PUT"}),e.ajax(l)}function o(){return t.apply(this,arguments),e.extend(l,{type:"DELETE"}),e.ajax(l)}e.restSetup={methodParam:"_method"},e(document).on("page:load ready",function(){e.extend(e.restSetup,{csrfParam:e("meta[name=csrf-param]").attr("content"),csrfToken:e("meta[name=csrf-token]").attr("content")})});var l,u=e.ajax;e.extend({ajax:i,read:r,create:a,update:s,destroy:o})}(jQuery),function(e,t,n){var i={required:"The %s field is required.",matches:"The %s field does not match the %s field.",valid_email:"The %s field must contain a valid email address.",min_length:"The %s field must be at least %s characters in length.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer."},r=function(){},a=/^(.+)\[(.+)\]$/,s=/^[0-9]+$/,o=/^\-?[0-9]+$/,l=/^\-?[0-9]*\.?[0-9]+$/,u=/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,6}$/i,h=/^[a-z]+$/i,c=/^[a-z0-9]+$/i,d=/^[a-z0-9_-]+$/i,f=function(e,n,i){for(this.callback=i||r,this.errors=[],this.fields={},this.form=t.forms[e]||{},this.messages={},this.handlers={},e=0,i=n.length;i>e;e++){var a=n[e];a.name&&a.rules&&(this.fields[a.name]={name:a.name,display:a.display||a.name,rules:a.rules,type:null,value:null,checked:null})}this.form.onsubmit=function(e){return function(t){try{return e._validateForm(t)
}catch(n){}}}(this)};f.prototype.setMessage=function(e,t){return this.messages[e]=t,this},f.prototype.registerCallback=function(e,t){return e&&"string"==typeof e&&t&&"function"==typeof t&&(this.handlers[e]=t),this},f.prototype._validateForm=function(e){this.errors=[];for(var t in this.fields)if(this.fields.hasOwnProperty(t)){var i=this.fields[t]||{},r=this.form[i.name];r&&r!==n&&(i.type=r.type,i.value=r.value,i.checked=r.checked),this._validateField(i)}if("function"==typeof this.callback&&this.callback(this.errors,e),this.errors.length>0){if(!e||!e.preventDefault)return!1;e.preventDefault()}return!0},f.prototype._validateField=function(e){var t=e.rules.split("|");if(-1!==e.rules.indexOf("required")||e.value&&""!==e.value&&e.value!==n)for(var r=0,s=t.length;s>r;r++){var o=t[r],l=null,u=!1;if((parts=a.exec(o))&&(o=parts[1],l=parts[2]),"function"==typeof this._hooks[o]?this._hooks[o].apply(this,[e,l])||(u=!0):"callback_"===o.substring(0,9)&&(o=o.substring(9,o.length),"function"==typeof this.handlers[o]&&this.handlers[o].apply(this,[e.value])===!1&&(u=!0)),u){(t=this.messages[o]||i[o])?(e=t.replace("%s",e.display),l&&(e=e.replace("%s",this.fields[l]?this.fields[l].display:l)),this.errors.push(e)):this.errors.push("An error has occurred with the "+e.display+" field.");break}}},f.prototype._hooks={required:function(e){var t=e.value;return"checkbox"===e.type?e.checked===!0:null!==t&&""!==t},matches:function(e,t){return(el=this.form[t])?e.value===el.value:!1},valid_email:function(e){return u.test(e.value)},min_length:function(e,t){return s.test(t)?e.value.length>=t:!1},max_length:function(e,t){return s.test(t)?e.value.length<=t:!1},exact_length:function(e,t){return s.test(t)?e.value.length==t:!1},greater_than:function(e,t){return l.test(e.value)?parseFloat(e.value)>parseFloat(t):!1},less_than:function(e,t){return l.test(e.value)?parseFloat(e.value)<parseFloat(t):!1},alpha:function(e){return h.test(e.value)},alpha_numeric:function(e){return c.test(e.value)},alpha_dash:function(e){return d.test(e.value)},numeric:function(e){return l.test(e.value)},integer:function(e){return o.test(e.value)}},e.FormValidator=f}(window,document),$(document).on("page:load ready",function(){elementPresent($("#channel_form"))&&($(".field_checkbox").click(function(){var e=$(this).val(),t=$("#channel_field"+e);$(this).is(":checked")?(t.removeAttr("readonly"),t.val("Field Label "+e),t.select()):(t.val(""),t.attr("readonly",!0))}),$("#channel_show_location").click(function(){$(this).is(":checked")?($("#channel_longitude").removeAttr("readonly"),$("#channel_latitude").removeAttr("readonly"),$("#label_longitude").removeClass("label-disabled"),$("#label_latitude").removeClass("label-disabled")):($("#channel_longitude").attr("readonly",!0),$("#channel_latitude").attr("readonly",!0),$("#label_longitude").addClass("label-disabled"),$("#label_latitude").addClass("label-disabled"))}),$("#channel_show_video").click(function(){$(this).is(":checked")?($('[name="channel[video_type]"]:radio').removeAttr("disabled"),$("#channel_video_id").removeAttr("readonly"),$("#label_youtube").removeClass("label-disabled"),$("#label_vimeo").removeClass("label-disabled"),$("#label_video_id").removeClass("label-disabled")):($('[name="channel[video_type]"]:radio').attr("disabled",!0),$("#channel_video_id").attr("readonly",!0),$("#label_youtube").addClass("label-disabled"),$("#label_vimeo").addClass("label-disabled"),$("#label_video_id").addClass("label-disabled"))}),$("form").submit(function(){$('[name="channel[video_type]"]:radio').removeAttr("disabled"),unbindBeforeUnloadEvents()}),confirmUnsavedChanges())});var elementPresent=function(e){return"string"==typeof e?0!==$(e).length:0!==e.length};$(window).on("page:load load",function(){var e=-90;$.fn.affix&&(setTimeout(function(){$("#bootstrap-sidebar").affix()},100),$(document.body).scrollspy({target:"#leftcol",offset:300}),$("#bootstrap-sidebar li a[href^='#']").on("click",function(t){t.preventDefault();var n=this.hash;$("html, body").animate({scrollTop:$(this.hash).offset().top+e},300,function(){window.location.hash=n})}))});var q=null;window.PR_SHOULD_USE_CONTINUATION=!0,function(){function e(e){function t(e){var t=e.charCodeAt(0);if(92!==t)return t;var n=e.charAt(1);return(t=c[n])?t:n>="0"&&"7">=n?parseInt(e.substring(1),8):"u"===n||"x"===n?parseInt(e.substring(2),16):e.charCodeAt(1)}function n(e){return 32>e?(16>e?"\\x0":"\\x")+e.toString(16):(e=String.fromCharCode(e),("\\"===e||"-"===e||"["===e||"]"===e)&&(e="\\"+e),e)}function i(e){for(var i=e.substring(1,e.length-1).match(/\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\S\s]|[^\\]/g),e=[],r=[],a="^"===i[0],s=a?1:0,o=i.length;o>s;++s){var l=i[s];if(/\\[bdsw]/i.test(l))e.push(l);else{var u,l=t(l);o>s+2&&"-"===i[s+1]?(u=t(i[s+2]),s+=2):u=l,r.push([l,u]),65>u||l>122||(65>u||l>90||r.push([32|Math.max(65,l),32|Math.min(u,90)]),97>u||l>122||r.push([-33&Math.max(97,l),-33&Math.min(u,122)]))}}for(r.sort(function(e,t){return e[0]-t[0]||t[1]-e[1]}),i=[],l=[0/0,0/0],s=0;s<r.length;++s)o=r[s],o[0]<=l[1]+1?l[1]=Math.max(l[1],o[1]):i.push(l=o);for(r=["["],a&&r.push("^"),r.push.apply(r,e),s=0;s<i.length;++s)o=i[s],r.push(n(o[0])),o[1]>o[0]&&(o[1]+1>o[0]&&r.push("-"),r.push(n(o[1])));return r.push("]"),r.join("")}function r(e){for(var t=e.source.match(/\[(?:[^\\\]]|\\[\S\s])*]|\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\\d+|\\[^\dux]|\(\?[!:=]|[()^]|[^()[\\^]+/g),n=t.length,r=[],o=0,l=0;n>o;++o){var u=t[o];"("===u?++l:"\\"===u.charAt(0)&&(u=+u.substring(1))&&l>=u&&(r[u]=-1)}for(o=1;o<r.length;++o)-1===r[o]&&(r[o]=++a);for(l=o=0;n>o;++o)u=t[o],"("===u?(++l,void 0===r[l]&&(t[o]="(?:")):"\\"===u.charAt(0)&&(u=+u.substring(1))&&l>=u&&(t[o]="\\"+r[l]);for(l=o=0;n>o;++o)"^"===t[o]&&"^"!==t[o+1]&&(t[o]="");if(e.ignoreCase&&s)for(o=0;n>o;++o)u=t[o],e=u.charAt(0),u.length>=2&&"["===e?t[o]=i(u):"\\"!==e&&(t[o]=u.replace(/[A-Za-z]/g,function(e){return e=e.charCodeAt(0),"["+String.fromCharCode(-33&e,32|e)+"]"}));return t.join("")}for(var a=0,s=!1,o=!1,l=0,u=e.length;u>l;++l){var h=e[l];if(h.ignoreCase)o=!0;else if(/[a-z]/i.test(h.source.replace(/\\u[\da-f]{4}|\\x[\da-f]{2}|\\[^UXux]/gi,""))){s=!0,o=!1;break}}for(var c={b:8,t:9,n:10,v:11,f:12,r:13},d=[],l=0,u=e.length;u>l;++l){if(h=e[l],h.global||h.multiline)throw Error(""+h);d.push("(?:"+r(h)+")")}return RegExp(d.join("|"),o?"gi":"g")}function t(e){function t(e){switch(e.nodeType){case 1:if(i.test(e.className))break;for(var n=e.firstChild;n;n=n.nextSibling)t(n);n=e.nodeName,("BR"===n||"LI"===n)&&(r[o]="\n",s[o<<1]=a++,s[o++<<1|1]=e);break;case 3:case 4:n=e.nodeValue,n.length&&(n=l?n.replace(/\r\n?/g,"\n"):n.replace(/[\t\n\r ]+/g," "),r[o]=n,s[o<<1]=a,a+=n.length,s[o++<<1|1]=e)}}var n,i=/(?:^|\s)nocode(?:\s|$)/,r=[],a=0,s=[],o=0;e.currentStyle?n=e.currentStyle.whiteSpace:window.getComputedStyle&&(n=document.defaultView.getComputedStyle(e,q).getPropertyValue("white-space"));var l=n&&"pre"===n.substring(0,3);return t(e),{a:r.join("").replace(/\n$/,""),c:s}}function n(e,t,n,i){t&&(e={a:t,d:e},n(e),i.push.apply(i,e.e))}function i(t,i){function r(e){for(var t=e.d,u=[t,"pln"],h=0,c=e.a.match(a)||[],d={},f=0,p=c.length;p>f;++f){var m,g=c[f],v=d[g],_=void 0;if("string"==typeof v)m=!1;else{var y=s[g.charAt(0)];if(y)_=g.match(y[1]),v=y[0];else{for(m=0;l>m;++m)if(y=i[m],_=g.match(y[1])){v=y[0];break}_||(v="pln")}!(m=v.length>=5&&"lang-"===v.substring(0,5))||_&&"string"==typeof _[1]||(m=!1,v="src"),m||(d[g]=v)}if(y=h,h+=g.length,m){m=_[1];var b=g.indexOf(m),w=b+m.length;_[2]&&(w=g.length-_[2].length,b=w-m.length),v=v.substring(5),n(t+y,g.substring(0,b),r,u),n(t+y+b,m,o(v,m),u),n(t+y+w,g.substring(w),r,u)}else u.push(t+y,v)}e.e=u}var a,s={};!function(){for(var n=t.concat(i),r=[],o={},l=0,u=n.length;u>l;++l){var h=n[l],c=h[3];if(c)for(var d=c.length;--d>=0;)s[c.charAt(d)]=h;h=h[1],c=""+h,o.hasOwnProperty(c)||(r.push(h),o[c]=q)}r.push(/[\S\s]/),a=e(r)}();var l=i.length;return r}function r(e){var t=[],n=[];t.push(e.tripleQuotedStrings?["str",/^(?:'''(?:[^'\\]|\\[\S\s]|''?(?=[^']))*(?:'''|$)|"""(?:[^"\\]|\\[\S\s]|""?(?=[^"]))*(?:"""|$)|'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$))/,q,"'\""]:e.multiLineStrings?["str",/^(?:'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$)|`(?:[^\\`]|\\[\S\s])*(?:`|$))/,q,"'\"`"]:["str",/^(?:'(?:[^\n\r'\\]|\\.)*(?:'|$)|"(?:[^\n\r"\\]|\\.)*(?:"|$))/,q,"\"'"]),e.verbatimStrings&&n.push(["str",/^@"(?:[^"]|"")*(?:"|$)/,q]);var r=e.hashComments;return r&&(e.cStyleComments?(t.push(r>1?["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,q,"#"]:["com",/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\n\r]*)/,q,"#"]),n.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,q])):t.push(["com",/^#[^\n\r]*/,q,"#"])),e.cStyleComments&&(n.push(["com",/^\/\/[^\n\r]*/,q]),n.push(["com",/^\/\*[\S\s]*?(?:\*\/|$)/,q])),e.regexLiterals&&n.push(["lang-regex",/^(?:^^\.?|[!+-]|!=|!==|#|%|%=|&|&&|&&=|&=|\(|\*|\*=|\+=|,|-=|->|\/|\/=|:|::|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|[?@[^]|\^=|\^\^|\^\^=|{|\||\|=|\|\||\|\|=|~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\s*(\/(?=[^*/])(?:[^/[\\]|\\[\S\s]|\[(?:[^\\\]]|\\[\S\s])*(?:]|$))+\/)/]),(r=e.types)&&n.push(["typ",r]),e=(""+e.keywords).replace(/^ | $/g,""),e.length&&n.push(["kwd",RegExp("^(?:"+e.replace(/[\s,]+/g,"|")+")\\b"),q]),t.push(["pln",/^\s+/,q," \r\n	\xa0"]),n.push(["lit",/^@[$_a-z][\w$@]*/i,q],["typ",/^(?:[@_]?[A-Z]+[a-z][\w$@]*|\w+_t\b)/,q],["pln",/^[$_a-z][\w$@]*/i,q],["lit",/^(?:0x[\da-f]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+-]?\d+)?)[a-z]*/i,q,"0123456789"],["pln",/^\\[\S\s]?/,q],["pun",/^.[^\s\w"-$'./@\\`]*/,q]),i(t,n)}function a(e,t){function n(e){switch(e.nodeType){case 1:if(a.test(e.className))break;if("BR"===e.nodeName)i(e),e.parentNode&&e.parentNode.removeChild(e);else for(e=e.firstChild;e;e=e.nextSibling)n(e);break;case 3:case 4:if(l){var t=e.nodeValue,r=t.match(s);if(r){var u=t.substring(0,r.index);e.nodeValue=u,(t=t.substring(r.index+r[0].length))&&e.parentNode.insertBefore(o.createTextNode(t),e.nextSibling),i(e),u||e.parentNode.removeChild(e)}}}}function i(e){function t(e,n){var i=n?e.cloneNode(!1):e,r=e.parentNode;if(r){var r=t(r,1),a=e.nextSibling;r.appendChild(i);for(var s=a;s;s=a)a=s.nextSibling,r.appendChild(s)}return i}for(;!e.nextSibling;)if(e=e.parentNode,!e)return;for(var n,e=t(e.nextSibling,0);(n=e.parentNode)&&1===n.nodeType;)e=n;u.push(e)}var r,a=/(?:^|\s)nocode(?:\s|$)/,s=/\r\n?|\n/,o=e.ownerDocument;e.currentStyle?r=e.currentStyle.whiteSpace:window.getComputedStyle&&(r=o.defaultView.getComputedStyle(e,q).getPropertyValue("white-space"));var l=r&&"pre"===r.substring(0,3);for(r=o.createElement("LI");e.firstChild;)r.appendChild(e.firstChild);for(var u=[r],h=0;h<u.length;++h)n(u[h]);t===(0|t)&&u[0].setAttribute("value",t);var c=o.createElement("OL");c.className="linenums";for(var d=Math.max(0,t-1|0)||0,h=0,f=u.length;f>h;++h)r=u[h],r.className="L"+(h+d)%10,r.firstChild||r.appendChild(o.createTextNode("\xa0")),c.appendChild(r);e.appendChild(c)}function s(e,t){for(var n=t.length;--n>=0;){var i=t[n];y.hasOwnProperty(i)?window.console&&console.warn("cannot override language handler %s",i):y[i]=e}}function o(e,t){return e&&y.hasOwnProperty(e)||(e=/^\s*</.test(t)?"default-markup":"default-code"),y[e]}function l(e){var n=e.g;try{var i=t(e.h),r=i.a;e.a=r,e.c=i.c,e.d=0,o(n,r)(e);var a=/\bMSIE\b/.test(navigator.userAgent),n=/\n/g,s=e.a,l=s.length,i=0,u=e.c,h=u.length,r=0,c=e.e,d=c.length,e=0;c[d]=l;var f,p;for(p=f=0;d>p;)c[p]!==c[p+2]?(c[f++]=c[p++],c[f++]=c[p++]):p+=2;for(d=f,p=f=0;d>p;){for(var m=c[p],g=c[p+1],v=p+2;d>=v+2&&c[v+1]===g;)v+=2;c[f++]=m,c[f++]=g,p=v}for(c.length=f;h>r;){var _,y=u[r+2]||l,b=c[e+2]||l,v=Math.min(y,b),w=u[r+1];if(1!==w.nodeType&&(_=s.substring(i,v))){a&&(_=_.replace(n,"\r")),w.nodeValue=_;var T=w.ownerDocument,$=T.createElement("SPAN");$.className=c[e+1];var x=w.parentNode;x.replaceChild($,w),$.appendChild(w),y>i&&(u[r+1]=w=T.createTextNode(s.substring(v,y)),x.insertBefore(w,$.nextSibling))}i=v,i>=y&&(r+=2),i>=b&&(e+=2)}}catch(S){"console"in window&&console.log(S&&S.stack?S.stack:S)}}var u=["break,continue,do,else,for,if,return,while"],h=[[u,"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],c=[h,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],d=[h,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"],f=[d,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"],h=[h,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"],p=[u,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],m=[u,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],u=[u,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"],g=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/,v=/\S/,_=r({keywords:[c,f,h,"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END"+p,m,u],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),y={};s(_,["default-code"]),s(i([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\S\s]*?(?:--\>|$)/],["lang-",/^<\?([\S\s]+?)(?:\?>|$)/],["lang-",/^<%([\S\s]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\S\s]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\S\s]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\S\s]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]),s(i([["pln",/^\s+/,q," 	\r\n"],["atv",/^(?:"[^"]*"?|'[^']*'?)/,q,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w-.:]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^\s"'>]*(?:[^\s"'/>]|\/(?=\s)))/],["pun",/^[/<->]+/],["lang-js",/^on\w+\s*=\s*"([^"]+)"/i],["lang-js",/^on\w+\s*=\s*'([^']+)'/i],["lang-js",/^on\w+\s*=\s*([^\s"'>]+)/i],["lang-css",/^style\s*=\s*"([^"]+)"/i],["lang-css",/^style\s*=\s*'([^']+)'/i],["lang-css",/^style\s*=\s*([^\s"'>]+)/i]]),["in.tag"]),s(i([],[["atv",/^[\S\s]+/]]),["uq.val"]),s(r({keywords:c,hashComments:!0,cStyleComments:!0,types:g}),["c","cc","cpp","cxx","cyc","m"]),s(r({keywords:"null,true,false"}),["json"]),s(r({keywords:f,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:g}),["cs"]),s(r({keywords:d,cStyleComments:!0}),["java"]),s(r({keywords:u,hashComments:!0,multiLineStrings:!0}),["bsh","csh","sh"]),s(r({keywords:p,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py"]),s(r({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["perl","pl","pm"]),s(r({keywords:m,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb"]),s(r({keywords:h,cStyleComments:!0,regexLiterals:!0}),["js"]),s(r({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]),s(i([],[["str",/^[\S\s]+/]]),["regex"]),window.prettyPrintOne=function(e,t,n){var i=document.createElement("PRE");return i.innerHTML=e,n&&a(i,n),l({g:t,i:n,h:i}),i.innerHTML},window.prettyPrint=function(e){function t(){for(var n=window.PR_SHOULD_USE_CONTINUATION?u.now()+250:1/0;c<i.length&&u.now()<n;c++){var r=i[c],s=r.className;if(s.indexOf("prettyprint")>=0){var o,f,s=s.match(d);if(f=!s){f=r;for(var p=void 0,m=f.firstChild;m;m=m.nextSibling)var g=m.nodeType,p=1===g?p?f:m:3===g&&v.test(m.nodeValue)?f:p;f=(o=p===f?void 0:p)&&"CODE"===o.tagName}for(f&&(s=o.className.match(d)),s&&(s=s[1]),f=!1,p=r.parentNode;p;p=p.parentNode)if(("pre"===p.tagName||"code"===p.tagName||"xmp"===p.tagName)&&p.className&&p.className.indexOf("prettyprint")>=0){f=!0;break}f||((f=(f=r.className.match(/\blinenums\b(?::(\d+))?/))?f[1]&&f[1].length?+f[1]:!0:!1)&&a(r,f),h={g:s,h:r,i:f},l(h))}}c<i.length?setTimeout(t,250):e&&e()}for(var n=[document.getElementsByTagName("pre"),document.getElementsByTagName("code"),document.getElementsByTagName("xmp")],i=[],r=0;r<n.length;++r)for(var s=0,o=n[r].length;o>s;++s)i.push(n[r][s]);var n=q,u=Date;u.now||(u={now:function(){return+new Date}});var h,c=0,d=/\blang(?:uage)?-([\w.]+)(?!\S)/;t()},window.PR={createSimpleLexer:i,registerLangHandler:s,sourceDecorator:r,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ"}}(),!function(e){e(function(){window.prettyPrint&&prettyPrint()})}(window.jQuery),$(document).on("page:load ready",function(){$(".response").click(function(){var e=$(this).data("response_type");$(".response").removeClass("active"),$(".response-"+e).addClass("active"),$(".format").hide(),$(".format-"+e).show()})});var alerts={showBanners:function(e){var t=document.getElementById(e);"none"===t.style.display&&(t.style.display="block")},hideBanners:function(e){var t=document.getElementById(e);"block"===t.style.display&&(t.style.display="none")},displayErrorAlert:function(e){alerts.showBanners(e)}},analysis_visualization_name_save={onmouseclick:function(e,t){$(e).val().trim()?(saveType="mouseClick",e.form.save.click()):alerts.displayErrorAlert(t)},onkeypress:function(e,t){13==event.keyCode&&(event.preventDefault(),$(e).val().trim()?(saveType="enter",e.form.save.click()):alerts.displayErrorAlert(t))}};$("#analysis_name_empty_error_close").on("click",function(){alerts.hideBanners(this.parentElement.id)}),$("#matlab_code_empty_warning_close").on("click",function(){alerts.hideBanners(this.parentElement.id)});var evalContainer,fevalContainer,evalDiv,fevalDiv,fevalImg,hiddenMcode,hiddenErrorTitle,hiddenTimeoutTitle,hiddenSuccessTitle,hiddenErrorMessage,unsavedChangesMessage,errored,erroredMessage,timeOutDetailText,codeEditor,mssInit=function(){evalContainer=$("#eval_container .collapse"),fevalContainer=$("#feval_container .collapse"),evalDiv=$("#eval"),fevalDiv=$("#feval_svg"),fevalImg=$("#feval_png"),hiddenMcode=getHiddenMcodeDiv(),hiddenErrorTitle=$("#error_title").val(),hiddenTimeoutTitle=$("#timeout_title").val(),timeOutDetailText=$("#timeout_detailed").val(),hiddenSuccessTitle=$("#success_title").val(),hiddenErrorMessage=$("#error_message").val(),unsavedChangesMessage=$("#unsaved_changes").val(),errored=$("#errored"),erroredMessage=$("#errored_timecontrol_react").val(),""!==hiddenErrorMessage&&displayError(hiddenErrorMessage),$("#clear").click(function(){clearHistory(),clearFEvalResponse()}),$(window).unbind("beforeunload.matlab").bind("beforeunload.matlab",function(){return matlabEditor.rtcPresent()&&unsavedChanges()?unsavedChangesMessage:void 0}),$(document).unbind("page:before-change.matlab").bind("page:before-change.matlab",function(){return matlabEditor.rtcPresent()&&unsavedChanges()&&!confirm(unsavedChangesMessage)?!1:void 0})},onEditorLoad=function(){$("#editorSpinner").hide(),codeEditor=window.editor.rtcInstance.document,matlabEditor.checkCodeChange(),mssInit(),matlabEditor.setMcode(),$("#commit").click(function(){matlabEditor.uiLock(),$(".dismiss").click(),hiddenMcode.val(matlabEditor.getMcode())}),$("#save").click(function(){"enter"!=saveType&&"mouseClick"!=saveType&&matlabEditor.uiLock(),$(".dismiss").click(),hiddenMcode.val(matlabEditor.getMcode())})},isPlugin=function(){return elementPresent(fevalContainer)},isMatlabIotAnalytic=function(){return elementPresent($("#matlab_iot_analytic_mcode"))},getHiddenMcodeDiv=function(){var e;return e=isMatlabIotAnalytic()?"#matlab_iot_analytic_mcode":isPlugin()?"#plugin_mcode":"#matlab_code_mcode",$(e)},elementPresent=function(e){return"string"==typeof e?0!==$(e).length:0!==e.length},unsavedChanges=function(){return matlabEditor.getMcode()!==hiddenMcode.val()},clearFEvalResponse=function(){elementPresent(fevalDiv)&&fevalDiv.children().remove(),elementPresent(fevalImg)&&(fevalImg.removeAttr("src"),fevalImg.hide())},clearHistory=function(){elementPresent(evalDiv)&&evalDiv.children().remove()},handleMSSResponse=function(e){if("error"in e&&null!==e.error)displayError(e.error),clearFEvalResponse();else if(displaySuccess(hiddenSuccessTitle),elementPresent(evalDiv)&&"eval"in e&&appendOutput(e.eval,!1),elementPresent(fevalDiv)&&"feval"in e){var t=e.feval;clearFEvalResponse(),"ggjson"in t&&null!==t.ggjson?handleWebPlotResponse(t.ggjson):"hgplot"in t&&null!==t.hgplot&&handlePlotResponse(t.hgplot)}},handlePlotResponse=function(e){fevalImg.attr("src",e).show()},handleWebPlotResponse=function(e){var t=JSON.parse(e);renderVega(t,"#feval_svg"),fevalImg.hide()},appendOutput=function(e,t){if(""!==e&&null!==e&&void 0!==e){e=e.replace(/\n/g,"<br>");var n=document.createElement("div");if(t===!0&&$(n).addClass("matlab_warning"),n.innerHTML=e,elementPresent(evalDiv)){var i=$(n).find("a");i.length>0&&$(i).click(interceptErrorUrl),$(document.createElement("hr")).appendTo(n),$(n).appendTo(evalDiv),$(evalDiv).scrollTop($(evalDiv).prop("scrollHeight"))}}},displayError=function(e,t){void 0===t&&(t="#root");var n=hiddenErrorTitle;"true"===errored.val()&&(n+=" "+erroredMessage),e===timeOutDetailText&&(n=hiddenTimeoutTitle),$('<div class="flash alert alert-danger"><span class="dismiss">X</span><p>'+n+"</p></div").insertBefore(t),$(".flash a").click(interceptErrorUrl),$(".dismiss").on("click",function(){$(this).parent().remove()}),appendOutput(e,!0)},displaySuccess=function(e,t){void 0===t&&(t="#root"),$(".alert-success").remove(),$('<div class="flash alert alert-success"><span class="dismiss">X</span><p>'+e+"</p></div").insertBefore(t),$(".dismiss").on("click",function(){$(this).parent().remove()}),setTimeout(function(){$("div.flash.alert.alert-success").length>0&&$(".flash").hide("slow")},15e3)},displayErrorFormElements=function(e,t){void 0===t&&(t="#root"),$(".alert-danger").remove(),$('<div class="flash alert alert-danger"><span class="dismiss">X</span><p id="error_message_p"> </p></div').insertBefore(t),$("#error_message_p").append(e),$(".dismiss").on("click",function(){$(this).parent().remove()}),setTimeout(function(){$("div.flash.alert.alert-danger").length>0&&$(".flash").hide("slow")},15e3)},interceptErrorUrl=function(e){"http"!==this.href.substring(0,4)&&(e.preventDefault(),evalErrorUrl(this.href,function(e){null!==e&&"eval"in e&&appendOutput(e.eval,!1)}))},evalErrorUrl=function(e,t){if(-1!==e.indexOf("matlab:")){var n=e.substring(0,7);if("matlab:"===n){var i=e.substring(7);n=i.substring(0,3),"doc"===n?(i=i.substring(4),window.open("http://www.mathworks.com/help/search.html?qdoc="+i)):$.ajax({method:"POST",url:"test_code",data:{mcode:i},dataType:"json"}).done(function(e){t(e)})}}},renderVega=function(e,t){var n=new thingSpeakWebplot;e.resizable=!0,e.resizableButtonVisible=!1,n.setSpec(e,t)!==!1&&(n.loadLibraries(),n.render(),n.resize())},matlabEditor={checkCodeChange:function(){document.getElementById("solutionBodyArea").onkeypress=function(){parent.document.getElementById("saveNeeded")&&(parent.document.getElementById("saveNeeded").innerHTML="*")}},rtcPresent:function(){return"undefined"!=typeof codeEditor},setMcode:function(){matlabEditor.rtcPresent()&&codeEditor.setText(hiddenMcode.val())},getMcode:function(){return matlabEditor.rtcPresent()?codeEditor.getText():void 0},uiUnlock:function(){matlabEditor.rtcPresent()&&(window.editor.rtcInstance.focus(),codeEditor.setReadOnly(!1))},uiLock:function(){matlabEditor.rtcPresent()&&(window.editor.rtcInstance.blur(),window.editor.resizeEditor(),codeEditor.setReadOnly(!0))}};$(document).on("page:load ready",function(){0!==$("#timecontrol_form").length&&(setFrequencyOption(),recurrancyHandler(),fixDateTime(),setWeekdays(),setSchedulable(),$("#timecontrol_run_at").datepicker({format:"yyyy-mm-dd",startDate:new Date}),$(".frequency_radio").change(function(){frequencyHandler(),displayFuzzyTimeOptions()}),$(".recurrance_radio").change(function(){recurrancyHandler()}),$("#timecontrol_schedulable_type").change(function(){$("#schedulable").fadeOut(function(){setSchedulable()}),$("#schedulable").fadeIn()}),$("#timecontrol_recurring_minute").change(function(){displayFuzzyTimeOptions()}))});var ThingSpeak=function(e){return e}(ThingSpeak||{}),setExhaustionAlertDefaults=function(){is_shutOff=!1,is_leu=!1,exhuastion_message_id="#call_of_action_exhaust",shut_off_message_id="#call_of_action_shutoff",expire_message_id="#call_of_action_expire",to_expire_message_id="#call_of_action_to_expire",$(".exhaustion_reminder").hide(),$(".expiration_reminder").hide(),$(".shutoff_alert").hide(),$(".shutoff_expiration_alert").hide(),currentDate=new Date,a_tag_id=null},checkMessageExhaustion=function(e,t,n,i,r,a){var s=!1;if(estimated_exhaustion_date=UsageVisualizations.estimateExhaustionOrExpirationDate(i.monthly,i.daily,a).Date,t.dateType=UsageVisualizations.estimateExhaustionOrExpirationDate(i.monthly,i.daily,a).DateType,1==is_shutOff)$("#license_id_val").text(e),$("#shut_off_date").text(moment(t.exhaustion_date).format("LL")),$(".shutoff_alert").show(),void 0!=r&&r===!0&&(s=!0);else if(void 0!=t.dateType&&"Expiration Date"===t.dateType&&estimated_exhaustion_date<currentDate)setExpirationAlert(e,n,!0),$("#license_id_val_expire_shutoff").text(e),$("#shut_off_date_exp").text(moment(estimated_exhaustion_date).format("LL")),n||$(".shutoff_expiration_alert").show();else{var o=Math.abs(estimated_exhaustion_date.getTime()-(new Date).getTime()),l=Math.ceil(o/864e5);45>=l&&(s=!0,void 0!=t.dateType&&"Expiration Date"===t.dateType?($("#license_id_val_expire").text(e),$("#expiration_date").text(moment(estimated_exhaustion_date).format("LL")),n||(setExpirationAlert(e,n,!1),$(".expiration_reminder").show())):(setExpirationAlert(e,n,!1),$("#license_id_val_exhaust").text(e),$("#exp_expiration_date").text(moment(estimated_exhaustion_date).format("LL")),$(".exhaustion_reminder").show()))}void 0!=r&&r===!0&&s===!0&&$("#monthly_usage_tab").is(":visible")&&$('#charts_tabs a[href="#monthly_usage"]').tab("show")},populateFreeUnitsLink=function(){1!=is_shutOff?$(exhuastion_message_id).attr("href","/prices"):$(shut_off_message_id).attr("href","/prices")},populateAlertMessages=function(e,t){1==is_leu?setMessageForLEU(t):setMessageForNonLEU(e,t)},setMessageForLEU=function(e){setAdminContactMessage(1!=e?exhuastion_message_id:shut_off_message_id)},setMessageForNonLEU=function(e,t){1!=t?setPurchaseUnitsMessage(exhuastion_message_id,e):setPurchaseUnitsMessage(shut_off_message_id,e)},populatePurchaseUnitsLink=function(e){$("#purchase_units_link").attr("href","/account/purchase/"+encodeURIComponent(e))},setAdminContactMessage=function(e){$(e).text("Contact your administrator.").removeClass("exhaustion_alert").removeAttr("href").addClass("contact_admin")},setPurchaseUnitsMessage=function(e,t){$(e).text("Purchase more units").attr("href","/account/purchase/"+encodeURIComponent(t)).attr("data-no-turbolink",!0)},setExpirationAlert=function(e,t,n){a_tag_id=1==n?expire_message_id:to_expire_message_id,1==t?$(a_tag_id).attr("href","/prices"):1==is_leu?$(a_tag_id).text("Contact your administrator.").removeClass("exhaustion_alert").removeAttr("href").addClass("contact_admin"):$(a_tag_id).text("Purchase more units").attr("href","/account/purchase/"+encodeURIComponent(e)).attr("data-no-turbolink",!0)};ThingSpeak.Channel=function(){function e(e){this.channel=e.channel,this.publicView=e.public_view,this.currentUserOwns=e.current_user_owns,this.windows=[],$("abbr.timeago").timeago();for(var t in e.windows)this.windows.push(ThingSpeak.Window.init(e.windows[t],this.currentUserOwns));if($("#invalid_update_interval_close").on("click",function(){$(this).parent().hide()}),$("#invalid_widget_parameter_close").on("click",function(){$(this).parent().hide()}),$("#invalid_widget_type_close").on("click",function(){$(this).parent().hide()}),$("#invalid_min_max_close").on("click",function(){$(this).parent().hide()}),$("#add_visualization_modal").on("show.bs.modal",function(){hiddenText=$("#add_visualization_empty_text"),$("#add_visualization_modal_content_body").children("div").length>0?hiddenText.attr("hidden","hidden"):hiddenText.removeAttr("hidden")}),$("#add_widget_modal").on("show.bs.modal",function(){hiddenText=$("#add_widget_empty_text"),$("#add_widget_modal_content_body").children("div").length>0?hiddenText.attr("hidden","hidden"):hiddenText.removeAttr("hidden")}),$("#add_widget_next").click(function(){var e=$(".window-preview-container-selected").find("#widget-metadata-id").html(),t=$("#channel-metadata-id").html();ThingSpeak.Widget.getNewWidgetParams(t,e,!0)}.bind(this)),$(".add_widget_cancel").click(function(){$(".window-preview-container-selected").removeClass("window-preview-container-selected");$("#channel-metadata-id").html()}.bind(this)),$("#configure_widget_parameters_modal").on("shown.bs.modal",function(){$(document).on("click","#display_value_",function(){this.value=$(this).is(":checked")?!0:!1})}.bind(this)),$("#configure_widget_parameters_modal").on("hide.bs.modal",function(){$("#min_max_error").hide(),$(".window-preview-container-selected").removeClass("window-preview-container-selected");$("#channel-metadata-id").html()}),$(document).on("click","#widget_add_range_",function(){plusButtonHelper("widget_params_config_")}),$(document).on("click","[id^=range_close_icon]",function(e){removeHelper(e.target.parentElement)}),$(document).on("click","#min_max_error_close",function(){widgetHelperFunctions.hideErrorBanner(this)}),$("#add_widget_create").click(function(){var e=$("#configure_widget_parameters_modal").find(".error_banner");if(!widgetHelperFunctions.verifyWidget(e,"#widget_params_config_",this.id))return!1;var t=this.publicView,n=[],i={},r=ThingSpeak.Widget.formWidgetParams();$(".window-preview-container-selected").each(function(e,a){{var s=$(".window-preview-container-selected").find("#widget-metadata-id").html();$("#channel-metadata-id").html()}i={public_flag:t,content_type:$(a).attr("content-type"),content_id:$(a).attr("content-id"),widget_type:s,parameters:r},n.push(i),$(this).toggleClass("window-preview-container-selected")}),ThingSpeak.Window.addVisualizations(this.channel.id,n)}.bind(this)),$(".window-preview-container").click(function(){$("#add_widget_modal_content_body > .window-preview-container-selected").each(function(e,t){t.classList.remove("window-preview-container-selected")}),$(this).toggleClass("window-preview-container-selected")}),$("#add_visualization_cancel").click(function(){$(".window-preview-container-selected").removeClass("window-preview-container-selected")}),$("#add_visualization_save").click(function(){var e=this.publicView,t=[],n={};$(".window-preview-container-selected").each(function(i,r){$(r).remove(),n={public_flag:e,content_type:$(r).attr("content-type"),content_id:$(r).attr("content-id")},t.push(n)}),ThingSpeak.Window.addVisualizations(this.channel.id,t)}.bind(this)),this.currentUserOwns){var n=function(){var e=[];$(".window-container").each(function(t,n){e.push(n.id.split("_")[1])});var t="/channels/"+this.channel.id+"/windows/reposition",n={public_flag:this.publicView,window_ids:e};$.ajax({url:t,method:"PUT",data:n,dataType:"json"})}.bind(this);this.sortable=Sortable.create($("#windows_container")[0],{sort:!0,delay:0,animation:150,handle:".window-header",draggable:".window-container",scroll:!0,scrollSensitivity:70,scrollSpeed:10,fallbackOnBody:!1,onEnd:n})}return this}var t=function(t){return new e(t)},n=function(e){var t=$.parseHTML(e);$(t).click(function(){$(this).toggleClass("window-preview-container-selected")}),$("#add_visualization_modal_content_body").append(t)};return{init:t,addVisualizationPreview:n}}();var widgetHelperFunctions={verifyWidget:function(e,t,n){return widgetHelperFunctions.minMaxError(t,n)?(e.show(),!1):!0
},updateTitle:function(e,t){t=void 0!=t?t:"";var n=$(e).find("#title_"+t)[0].value,t="#window_"+t,i=" .window-title",r=t+i;$(r).html(n)},minMaxError:function(e,t){t=void 0!=t?t:"";var n=$(e).find("#min_"+t)[0].value,i=$(e).find("#max_"+t)[0].value;return widgetHelperFunctions.checkMaxMinValue(n,i)},checkMaxMinValue:function(e,t){return Number(e)>=Number(t)?!0:!1},hideErrorBanner:function(e){var t=$("#"+$(e).parents()[4].id).find(".error_banner");t.hide()}},loadMeterData=function(e){var t;$("#available_licenses").change(function(){var e=this.value,t=$("#channel-metadata-id").html();$.ajax({url:"/channels/update_license",method:"POST",data:{channel_id:t,license:e},dataType:"html"})}),t=e.is_free_user?e.free_license_id:e.is_a_staff?e.staff_license_id:$("#available_licenses").val(),loadMeterInfo(t),$("#available_licenses").change(function(){loadMeterInfo($("#available_licenses").val())})},setDefaultsChannels=function(){$("input#upload_csv_channel_btn").removeAttr("disabled")},loadMeterInfo=function(e){setExhaustionAlertDefaults();var t;setDefaultsChannels(),1==meter_data.is_free_user?(1==meter_data.has_exhausted&&(is_shutOff=!0,t="Importing data into a channel requires messages. Buy a new license."),populateFreeUnitsLink()):meter_data.licenses.forEach(function(n){n.license_id==e&&(null!=n.has_exhausted&&(is_shutOff=!0,t="Importing data into a channel requires messages. Purchase more units."),1==n.is_an_leu&&(is_leu=!0,t="Importing data into a channel requires messages. Contact your license administrator."),populatePurchaseUnitsLink(e),populateAlertMessages(e,is_shutOff))}),findDailyAndMonthlyUsage(e),is_shutOff===!0&&($("input#upload_csv_channel_btn").addClass("enable_events_disabled_elements"),$("input#upload_csv_channel_btn").attr("disabled","disabled"),$("input#upload_csv_channel_btn").attr("title",t))},monthlyData,dailyData,findDailyAndMonthlyUsage=function(e){var t=!1,n={daily:void 0,monthly:void 0},i={userType:meter_data.user_type},r=0;meter_data.is_free_user||jQuery.isEmptyObject(meter_data.licenses)||meter_data.licenses.forEach(function(n){n.license_id==e&&(t=n.is_an_leu,r=n.total_remaining_messages_per_license)}),meter_data.is_free_user?(i.number_of_messages_per_unit=meter_data.free_messages_per_year,i.messages_remaining=meter_data.licenses[0].messages_remaining):(i.number_of_messages_per_unit=meter_data.messages_per_paid_unit,i.messages_remaining=r);var a=function(e){n.daily=e,o(n)},s=function(e){n.monthly=e,o(n)},o=function(t){t.daily&&t.monthly&&checkMessageExhaustion(e,meter_data,meter_data.is_free_user,n,!1,i)},l=5e3;$.ajax({url:"/account/daily_usage.json",cache:!1,data:{lid:e,is_an_leu:t},dataType:"json",tryCount:0,retryLimit:1,timeout:l}).done(a).fail(function(e){if(200==e.status||304==e.status);else if(this.tryCount++,this.tryCount<=this.retryLimit)return void $.ajax(this)}),$.ajax({url:"/account/monthly_usage.json",cache:!1,data:{lid:e,is_an_leu:t},dataType:"json",tryCount:0,retryLimit:1,timeout:l}).done(s).fail(function(e){if(200==e.status||304==e.status);else if(this.tryCount++,this.tryCount<=this.retryLimit)return void $.ajax(this)})},usagePurposeModal={show_hide_usage_modal:function(){usage_purpose_modal_flag?$("#usage_purpose_modal").modal("hide"):($("#usage_purpose_modal").modal("show"),$("#submit_intent_of_use").attr("disabled","disableClick"),$("#usage_purpose_modal").on("click",".project_type",function(){$("#submit_intent_of_use").removeAttr("disabled")}))}},plusButtonHelper=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=$("#range_meta_key_"+t).html(),i=Math.floor(9e5*Math.random())+1e5,r="<tr><td class='widget-table-cells'></td><td class='widget-table-cells'><input class='form-control' type='number' step='any' name='range_start_"+n+"' value='0'></td><td class='widget-table-cells'><input class='form-control' type='number' step='any' name='range_end_"+n+"' value='0'></td><td class='widget-table-cells'><input class='form-control' value=#"+i+" name='range_color_"+n+"' type='color'></input></td><td name='"+t+"' class='color-range-row'><span id ='range_close_icon_"+n+"'class='close' aria-hidden='true'>&times;</span></td></tr>";document.getElementById(e).insertAdjacentHTML("beforeend",r),null!=document.getElementById("range_meta_key_")&&(document.getElementById("range_meta_key_"+t).innerHTML=Number(n)+1)};$(document).ready(function(){"channels"===location.pathname.substring(1)&&usagePurposeModal.show_hide_usage_modal()}),ThingSpeak.Window=function(){function e(e,t){return this.initialize=function(e,t){for(var n in e)this[n]=e[n];if(null!==this.html&&$("#windows_container").append($.parseHTML(this.html)),this.container=$("#window_"+this.id),this.iframeModal=$("#window_iframe_modal_"+this.id),this.iframe=$("#window_iframe_"+this.id),t){if(this.optionsModal=$("#window_options_modal_"+this.id),this.options_json=JSON.parse(this.options_json),$(this.container).find("#remove_window_"+this.id).click(this.remove.bind(this)),$("#window_options_modal_save_"+this.id).click(this.update_options.bind(this)),$("#window_widget_options_modal_save_"+this.id).click(this.update_widget_params.bind(this)),$("#widget_options_modal_open_"+this.id).click(this.widget_options_modal_open.bind(this)),$(this.optionsModal).on("hidden.bs.modal",this.reset_options.bind(this)),"widget"==this.content_type){var i=this.id;$("#window_widget_options_modal_"+i).on("shown.bs.modal",function(){$(document).on("click","#display_value_"+i,function(){this.value=$(this).is(":checked")?!0:!1})}.bind(this)),$(document).on("click","#widget_add_range_"+i,function(){var e="widget_params_config_"+i;plusButtonHelper(e,i)})}$(this.optionsModal).find(".mutuallyexclusive").change(function(e){var t=$(e.target),n=t.attr("id");t.parents("div.modal-body").find(".mutuallyexclusive").each(function(e,t){t.id!==n&&$(t).val("")})}),this.reset_options()}return this},this.widget_options_modal_open=function(){$(".error_banner").hide();var e=this.id,t=this.channel_id,n=this.content_id,i="widget_options_modal_content_body_",r="/channels/"+t+"/widgets/"+n+".json";$("#"+i).hide(),$.ajax({method:"GET",url:r,success:function(t){$("#"+i).show(),ThingSpeak.Widget.constructConfigModal({params:JSON.parse(t.parameters),enabled_fields:t.enabled_fields},i,e,Number(t.widget_type))},error:function(){$("#"+i).innerHTML="Failed to fetch value from the server."}})},this.update_widget_params=function(){var e=$("#window_widget_options_modal_"+this.id).find(".error_banner");if(!widgetHelperFunctions.verifyWidget(e,"#widget_params_config_"+this.id,this.id))return!1;widgetHelperFunctions.updateTitle("#widget_params_config_"+this.id,this.id);var t=this.id,n=this.channel_id,i="/channels/"+n+"/widgets/"+this.content_id,r=ThingSpeak.Widget.formWidgetParams(t),a={paramData:r};$.ajax({method:"PUT",data:a,url:i,error:function(e){400==e.status&&(document.getElementById("widget-config-err-msg").innerHTML=JSON.parse(e.responseText).error_message,$("#window_widget_options_modal_"+t).modal("hide"),$("#invalid_widget_parameter").show())},success:function(){document.getElementById("window_iframe_"+t).src+="",$("#window_widget_options_modal_"+t).modal("hide")}})},this.update_options=function(){var e=function(){var e={},t=function(){var t=this.id.split("_")[1],n=$(this).val();""!=n&&(e[t]=n)};return this.optionsModal.find(".form-control").each(t),e}.bind(this),t=function(e){this.iframe_html=e.iframe_html,this.iframe_src=e.iframe_src,this.options=e.options,this.options_json=JSON.parse(e.options_json),$(this.iframe)[0].src=this.iframe_src,$(this.iframeModal).find("pre").text(this.iframe_html),$(this.optionsModal).modal("hide")}.bind(this),n={window_update:"chart_options",options:e()};this.post(n,"json",t)},this.reset_options=function(){var e=this.options_json,t=function(){var t=this.id.split("_")[1];$(this).val(e[t])};this.optionsModal.find(".form-control").each(t)},this.remove=function(){var e=!0;if("widget"==this.content_type&&(e=confirm("Are you sure you want to delete this widget?")),e){$(this.container).remove();var t={window_update:"remove"};this.post(t,"script")}},this.post=function(e,t,n,i){$.ajax({method:"PUT",url:this.url,data:e,dataType:t}).done(n).error(i)},this.initialize(e,t)}var t=function(t,n){return new e(t,n)},n=function(e){return widgetFlag=!1,e.forEach(function(e){"widget"===e.content_type&&(widgetFlag=!0)}),widgetFlag},i=function(e,t){data={windows:JSON.stringify(t)},$.ajax(n(t)?{method:"POST",url:"/channels/"+e+"/windows/create_widget",data:data,dataType:"script",error:function(e){400==e.status&&(document.getElementById("widget-config-err-msg").innerHTML=JSON.parse(e.responseText).error_message,$("#invalid_widget_parameter").show())}}:{method:"POST",url:"/channels/"+e+"/windows",data:data,dataType:"script"})};return{init:t,addVisualizations:i}}(),$(document).on("page:load ready",function(){function e(){1==visualization_public_flag?($("#url_checkbox").attr("checked","checked"),r()):($("#url_checkbox").removeAttr("checked"),a())}if(elementPresent($("#channel_ids"))||elementPresent($("#visualization_url_div"))){if(elementPresent($("#results_container"))&&pluginDisplaySettings.hidePlotAndCodeOutput(),elementPresent($("#channel_listings_parent_div"))&&(pluginDisplaySettings.populateShowChannels(),pluginDisplaySettings.toggleFontAwesomePlusSign()),elementPresent($("#channel_ids")))var t=(JSON.parse($("#channel_ids").val()),JSON.parse($("#public_channel_ids").val())),n=$("#visualization_is_private_text").val();var i={displaySharingError:function(){$("#visualization_name_empty_error").show()},displayFlagSaveError:function(){$("#visualization_flag_save_error").show()}},r=function(){$("#visualization_URL").prop("placeholder",""),$("#visualization_URL").prop("value",visualization_public_url),document.getElementById("visualization_URL").style.cursor="default",$("#copy_button").show(),$("#visualization_child_div").addClass("input-group")},a=function(){$("#visualization_URL").prop("placeholder",""),$("#visualization_URL").prop("value",""),document.getElementById("visualization_URL").style.cursor="not-allowed",$("#copy_button").hide()};elementPresent($("#visualization_url_div"))&&e(),$("#visualization_text_field").on("change",function(){$(this).val().trim()?(saveType="mouseClick",this.form.save.click()):i.displaySharingError()}),$("#visualization_text_field").on("keypress",function(e){13==e.keyCode&&(e.preventDefault(),$(this).val().trim()?(saveType="enter",this.form.save.click()):i.displaySharingError())}),$("#url_checkbox").on("click",function(){if(this.checked){if(visualization_public_flag=!0,elementPresent($("#channel_ids")))for(var e=0;e<t.length;e++)$("#public_"+t[e]).attr("disabled",!1).removeAttr("title")}else if(visualization_public_flag=!1,elementPresent($("#channel_ids")))for(var e=0;e<t.length;e++)$("#public_"+t[e]).attr("checked",!1).attr("title",n).attr("disabled",!0);s(!visualization_public_flag),o()});var s=function(e){1==e?a():r()},o=function(){var e=save_public_flag_url,t={public_flag:visualization_public_flag};$.ajax({url:e,method:save_public_flag_url_http_verb,data:t}).fail(function(){i.displayFlagSaveError()})};elementPresent($("#channel_ids"))&&($.tablesorter.addParser({id:"checkbox",is:function(){return!1},format:function(e,t,n){return $(n).children().last().is(":checked")?1:0},type:"numeric"}),$("#add_to_channel_table").tablesorter({headers:{2:{sorter:"checkbox"},3:{sorter:"checkbox"}},widgets:["stickyHeaders"],widgetOptions:{stickyHeaders_attachTo:".add-to-channel-table"},initialized:function(e){var t=!1;$(e).find("input[type=checkbox]").each(function(){$(this).bind("change",function(){$(e).trigger("updateCell",[$(this).closest("td")[0],t])})})}}))}});var elementPresent=function(e){return"string"==typeof e?0!==$(e).length:0!==e.length},pluginDisplaySettings={populateShowChannels:function(){$("#channels_list").html(""),selected=!1;for(var e,t=document.getElementById("add_to_channel_table"),n=1;e=t.rows[n];n++){arr=[];for(var i,r=0;i=e.cells[r];r++)arr[r]=2>r?i.innerHTML:i.getElementsByTagName("input")[1].checked;channel_name=arr[0],channel_id=arr[1],private_view_checkbox_val=arr[2],public_view_checkbox_val=arr[3],is_private=private_view_checkbox_val===!0?"private view":"",is_public=""===is_private?public_view_checkbox_val===!0?"public view":"":public_view_checkbox_val===!0?", public view":"",1!=(""===is_private&&""===is_public)&&(selected=!0,$("#channels_list").append("private view"===is_private?'<li class="list-group-item list-group-channels list-group-item-light"><a href="/channels/'+channel_id+'/private_show">'+channel_name+"</a> ("+channel_id+") - "+is_private+is_public+"</li>":'<li class="list-group-item list-group-channels list-group-item-light"><a href="/channels/'+channel_id+'/">'+channel_name+"</a> ("+channel_id+") - "+is_public+"</li>"))}selected||($("#channels_list").html(""),$("#channels_list").append('<li class="list-group-item list-group-channels list-group-item-light"> None </li>'))},toggleFontAwesomePlusSign:function(){$(".collapse").on("show.bs.collapse",function(){$(this).parent().find(".fa").removeClass("fa-plus").addClass("fa-minus")}).on("hide.bs.collapse",function(){$(this).parent().find(".fa").removeClass("fa-minus").addClass("fa-plus")})},hidePlotAndCodeOutput:function(){is_error?($("#feval_container").show(),$("#eval_container").show()):($("#feval_container").hide(),$("#eval_container").hide())}},usageVisualizationCharts=null;UsageVisualizations=function(){function e(e,t){var n=new Date;n=new Date(n.getFullYear(),n.getMonth(),n.getDate());for(var i=0,r=0,a=0;a<e.units.length;a++)if(void 0!==e.units[a].endDate&&new Date(e.units[a].endDate).getTime()+86400>=n.getTime()&&void 0!==e.units[a].qty&&(i+=e.units[a].qty*t,void 0!==e.units[a].usages))for(var s=0;s<e.units[a].usages.length;s++)if(void 0!==e.units[a].usages[s].months)for(var o=0;o<e.units[a].usages[s].months.length;o++)e.units[a].qty>0&&(r+=e.units[a].usages[s].months[o]);var l={};return l[0]=i,l[1]=r,l}function t(t,n){var i={};i[0]="Invalid Date",i[1]="Unknown Monthly Usage";var r=new Date,s=new Date(r.getTime()-30*a);s<new Date("2016-12-05")&&(s=new Date("2016-12-05"));var o=s.getYear()+1900,l=r.getMonth()-1,u=s.getMonth();if(1>l&&(l=12),void 0===t||void 0===t.units)return i;for(var h=0,c=[],d=0,f=0;f<t.units.length;f++)if(void 0!==t.units[f].usages)for(var p=0;p<t.units[f].usages.length;p++)if(void 0!==t.units[f].usages[p].year&&t.units[f].usages[p].year>=o&&void 0!==t.units[f].usages[p].months)for(var m=0;m<t.units[f].usages[p].months.length;m++)if(m>=u&&l>=m){var g=new Date(t.units[f].endDate);t.units[f].qty>0&&g>=s&&(c[d]=[t.units[f].usages[p].year,m],d+=1,h+=t.units[f].usages[p].months[m])}for(var v,_=[],f=0;f<c.length;f++){v=0;for(var p=0;p<_.length;p++)c[f][0]===_[p][0]&&c[f][1]===_[p][1]&&(v=1);0===v&&_.push(c[f])}var y=0;_.length>0&&(y=h/_.length);var b=e(t,n),w=b[0],T=b[1],$=new Date((new Date).getTime()+366*a);return y>0&&($=new Date((new Date).getTime()+30*a*Math.floor((w-T)/y))),"Invalid Date"===$.toDateString()&&($=new Date((new Date).getTime()+366*a)),i[0]=$,i[1]=y,i}function n(e,n,i){var r=0,u=3e6,h=0,c=1,d=0;void 0!==i&&void 0!==i.userType&&(r=parseInt(i.userType)),void 0!==i&&void 0!==i.number_of_messages_per_unit&&(u=parseInt(i.number_of_messages_per_unit)),void 0!==i&&void 0!==i.display_recommended_units&&(h=parseInt(i.display_recommended_units)),void 0!==i&&void 0!==i.proposed_num_of_units&&(c=parseInt(i.proposed_num_of_units),d=1),1>c&&(c=1);var f={chart:{renderTo:n,animation:!1,type:"column"},title:{text:null},xAxis:{categories:[]},yAxis:{min:0,title:{text:"Messages remaining"},stackLabels:{enabled:!1,style:{fontWeight:"bold"}}},legend:{align:"right",x:-30,verticalAlign:"top",y:25,floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.background2||"white",borderColor:"#CCC",borderWidth:1,shadow:!1,layout:"vertical"},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!1}}},series:[],credits:{enabled:!1}};if(void 0===e)return f.chart.height=120,f.yAxis.title.text=null,usageVisualizationCharts=new Highcharts.Chart(f),usageVisualizationCharts.showLoading(1===h?"Not enough data has been collected to display monthly data usage or recommend number of units required at current usage rate. A chart will be populated after at least one month of data has been collected.":"Not enough data has been collected to display monthly data usage. A chart with monthly usage information will be populated after at least one month of data has been collected."),c;if(void 0===e.units||0===e.units.length)return f.chart.height=120,f.yAxis.title.text=null,usageVisualizationCharts=new Highcharts.Chart(f),usageVisualizationCharts.showLoading("This license does not appear to have any available ThingSpeak units."),c;var p=0;for(D=0;D<e.units.length;D++)void 0!==e.units[D].endDate&&e.units[D].qty>0&&e.units[D].usages.length>0&&(p+=1);if(0===p)return f.chart.height=120,f.yAxis.title.text=null,usageVisualizationCharts=new Highcharts.Chart(f),usageVisualizationCharts.showLoading(1===h?"Not enough data has been collected to display monthly data usage or recommend number of units required at current usage rate. A chart will be populated after at least one month of data has been collected.":"A chart with monthly usage information will be populated after at least one month of data has been collected."),c;if(d&&h){var m={},g=new Date;m.id=0,m.qty=c;var v=g.getFullYear(),_=g.getMonth()+1,y=g.getDate();10>_&&(_="0"+_),_>11&&(_="01",v+=1),10>y&&(y="0"+y),m.startDate=v+"-"+_+"-"+y;var b=new Date(g.getTime()+365*a),w=b.getFullYear(),T=b.getMonth()+1,$=b.getDate();10>T&&(T="0"+T),T>11&&(T="01",w+=1),10>$&&($="0"+$),m.endDate=w+"-"+T+"-"+$;var x=[{}];x[0].year=g.getFullYear(),x[0].months=[0,0,0,0,0,0,0,0,0,0,0,0],m.usages=x,e.units.push(m)}for(var S=new Date,E=new Date(e.units[0].endDate),D=0;D<e.units.length;D++)if(void 0!==e.units[D].endDate&&e.units[D].qty>0){var k=new Date(e.units[D].endDate);k>S&&(S=new Date(k.getTime())),E>new Date(e.units[D].startDate)&&(E=new Date(e.units[D].startDate))}var R=t(e,u),C=R[0],A=R[1];("Invalid Date"===C.toDateString()||C>=S)&&(C=S);var M=new Date(Math.max(C.getTime(),S.getTime())+31*a),O=new Date(M-424*a);E>O&&(O=E);for(var U=[],D=0;D<e.units.length;D++)if(e.units[D].qty>0&&new Date(e.units[D].endDate)>=O){var I=[],N=[],L=O,P=0;if(0===e.units[D].usages.length){var q=O.getMonth(),B=O.getFullYear();do N.push(0),L=new Date(B+"-"+o[q][0]+"-"+o[q][1]),q+=1,q>11&&(q=0,B+=1);while(M>L);N.splice(N.length-1);var F=O.getMonth()+1;10>F&&(F="0"+F);var V=O.getDate();10>V&&(V="0"+V),I=[e.units[D].id,e.units[D].qty,e.units[D].startDate,e.units[D].endDate,O.getFullYear()+"-"+F+"-"+V,N,P]}else{var j;for(j=0;j<e.units[D].usages.length&&e.units[D].usages[j].year!==O.getFullYear();j++);var q=O.getMonth(),B=O.getFullYear();do L=new Date(B+"-"+o[q][0]+"-"+o[q][1]),N.push(e.units[D].usages.length>j&&void 0!==e.units[D].usages[j].months&&e.units[D].usages[j].months.length>=q?e.units[D].usages[j].months[q]:0),q+=1,q>11&&(q=0,B+=1,j+=1);while(M>L);N.splice(N.length-1);var H=O.getMonth()+1;10>H&&(H="0"+H);var K=O.getDate();10>K&&(K="0"+K),I=[e.units[D].id,e.units[D].qty,e.units[D].startDate,e.units[D].endDate,O.getFullYear()+"-"+H+"-"+K,N,P]}for(var J=new Date(e.units[D].startDate),k=new Date(e.units[D].endDate),z=0,Y=0;Y<e.units[D].usages.length;Y++)for(var G=0;G<e.units[D].usages[Y].months.length;G++){var W=G>=J.getMonth(),X=e.units[D].usages[Y].year>=J.getFullYear(),Q=G<O.getMonth(),Z=e.units[D].usages[Y].year<=O.getFullYear();W&&X&&Q&&Z&&(z+=e.units[D].usages[Y].months[G])}var et=e.units[D].qty*u-z;z===u&&(I[6]=1),I[5][0]=et,U.push(I)}for(var D=0;D<U.length-1;D++)if(new Date(U[D][3])>new Date(U[D+1][3])){var tt=U[D];U[D]=U[D+1],U[D+1]=tt}for(var nt=[],it=[],D=0;D<U.length;D++){var rt,j=1,at=0,st=0,ot=new Date,lt=ot.getMonth()+1;10>lt&&(lt="0"+lt),ot=new Date(ot.getFullYear()+"-"+lt+"-"+o[ot.getMonth()][1]);do{rt=new Date(U[D][4]),at=new Date(U[D][4]).getMonth()+j,st=Math.floor(at/12),at%=12;var ut=at+1;if(10>ut&&(ut="0"+ut),rt=new Date(rt.getFullYear()+st+"-"+ut+"-"+o[at][1]),rt>=ot)break;U[D][5][j]=U[D][5][j-1]-U[D][5][j],U[D][5][j]<0&&(U[D][5][j]=0),j+=1}while(ot>rt&&rt<new Date(U[D][3]));it[D]=U[D].slice(),it[D][5]=U[D][5].slice();for(var ht=0;l>ht;ht++)it[D][5][ht]=0;var P=0;at=new Date(it[D][4]).getMonth()+1;var ut=at;10>ut&&(ut="0"+ut);var ct=new Date(new Date(it[D][4]).getFullYear()+"-"+ut+"-"+o[at-1][1]);if(new Date(it[D][3])>new Date&&0===P&&(0===D||nt.length>0&&ct>nt[0]?(it[D][5][j]=U[D][5][j-1]-A,it[D][5][j]<0&&(it[D][5][j]=0,nt[0]=ct,nt[1]=0)):it[D][5][j]=U[D][5][j-1],it[D][5][j]>0))for(var ht=j+1;l-1>ht;ht++){st=0,at=new Date(it[D][4]).getMonth()+ht,st=Math.floor(at/12),at%=12,ut=at+1,10>ut&&(ut="0"+ut),ct=new Date(new Date(it[D][4]).getFullYear()+st+"-"+ut+"-"+o[at][1]);var dt=new Date(it[D][3]),ft=dt.getMonth()+1;10>ft&&(ft="0"+ft);var pt=dt.getUTCDate();if(10>pt&&(pt="0"+pt),dt=new Date(dt.getFullYear()+"-"+ft+"-"+pt),ct.getMonth()>dt.getMonth()&&ct.getFullYear()>=dt.getFullYear()){nt[0]=new Date(ct.getTime()),nt[1]=it[D][5][ht-1]>A?0:it[D][5][ht-1]-A;break}if(it[D][5][ht]=0===D||nt.length>0&&ct>=nt[0]?it[D][5][ht-1]-A:it[D][5][ht-1],it[D][5][ht]<0&&(it[D][5][ht]=0,0===P)){nt[0]=new Date(ct.getTime()),nt[1]=-it[D][5][ht],P=1;break}}}for(var D=0;D<U.length-1;D++)if(new Date(U[D][3])>new Date(U[D+1][3])){var tt=U[D];U[D]=U[D+1],U[D+1]=tt;var mt=it[D];it[D]=it[D+1],it[D+1]=mt}var gt=0;do{gt=0;for(var D=0;D<U.length;D++)1===U[D][6]&&(U.splice(D,1),it.splice(D,1),gt=1)}while(1===gt);for(var D=0;D<U.length;D++){var vt=[];O=new Date(U[D][4]);for(var j=0;l>j;j++){var _t=O.getFullYear(),yt=O.getMonth()+j;_t+=Math.floor(yt/12),yt%=12,vt.push([new Date(_t+"-"+o[yt][0][0]+"-"+o[yt][0][1]),U[D][5][j]])}var bt={};bt.name=3==r?"Remaining messages (purchase "+U[D][2]+")":"Remaining messages (free messages start date "+U[D][2]+")",bt.data=vt,bt.color="rgba("+s[D%s.length][0]+","+s[D%s.length][1]+","+s[D%s.length][2]+",1)",f.series.push(bt)}for(var D=0;D<it.length;D++){vt=[],O=new Date(it[D][4]);for(var j=0;l>j;j++)_t=O.getFullYear(),yt=O.getMonth()+j,_t+=Math.floor(yt,12),yt%=12,vt.push([new Date(_t+"-"+o[yt][0][0]+"-"+o[yt][0][1]),it[D][5][j]]);var wt={};wt.name=3==r?"Projected# messages remaining (purchase "+it[D][2]+")":"Projected# messages remaining (free messages renewal date "+it[D][2]+")",wt.data=vt,wt.color="rgba("+s[D%s.length][0]+","+s[D%s.length][1]+","+s[D%s.length][2]+",0.25)",f.series.push(wt)}for(var Tt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],$t=new Date(O),xt=$t.getMonth(),St=$t.getFullYear(),Et=0;l>Et;)f.xAxis.categories.push(Tt[xt]+" "+St),xt++,xt>11&&(xt=0,St+=1),Et++;return f.series.reverse(),usageVisualizationCharts=new Highcharts.Chart(f),d&&h&&e.units.pop(),c}function i(e,t,n,i){var r=0,s=3e6,o=0,l=0,h=0;void 0!==n&&void 0!==n.userType&&(r=parseInt(n.userType)),void 0!==n&&void 0!==n.number_of_messages_per_unit&&(s=parseInt(n.number_of_messages_per_unit)),void 0!==n&&void 0!==n.display_recommended_units&&(o=parseInt(n.display_recommended_units)),void 0!==n&&void 0!==n.proposed_num_of_units&&(l=parseInt(n.proposed_num_of_units),h=1),i=void 0!==i?parseInt(i):1/0;var c={chart:{renderTo:t,animation:!1},title:{text:null},xAxis:{type:"datetime",labels:{rotation:-45},dateTimeLabelFormats:{day:"%e-%b-%Y"},title:{text:null}},yAxis:{min:0,title:{text:"Messages used per day"},stackLabels:{enabled:!1,style:{fontWeight:"bold",color:Highcharts.theme&&Highcharts.theme.textColor||"gray"}}},legend:{align:"right",x:-30,verticalAlign:"top",y:25,floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.background2||"white",borderColor:"#CCC",borderWidth:1,shadow:!1,layout:"vertical",enabled:!0},tooltip:{formatter:function(){return messageText=1!==this.y?"messages":"message","<b>"+this.y+" "+messageText+"</b> used on "+Highcharts.dateFormat("%e-%b-%Y",new Date(this.x))}},plotOptions:{column:{stacking:"normal",events:{legendItemClick:function(){return!1}},showInLegend:!1,dataLabels:{enabled:!1,color:Highcharts.theme&&Highcharts.theme.dataLabelsColor||"white",style:{textShadow:"0 0 3px black"}}}},series:[{name:"Daily ThingSpeak message usage",data:[],marker:{enabled:!1},enableMouseTracking:!0,type:"column",color:"rgba(6,154,71,1)"}],credits:{enabled:!1}},d=[],f=new Date;f=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,-1*f.getTimezoneOffset());var p=new Date(f-u*a);if(void 0===e||void 0===e.startDate||void 0===e.datapoints||0===e.datapoints)return c.chart.height=120,c.yAxis.title.text=null,c.xAxis.lineWidth=0,usageVisualizationCharts=new Highcharts.Chart(c),void usageVisualizationCharts.showLoading("Not enough data has been collected to display daily data usage. A chart with daily usage information will be populated after at least one day of data has been collected.");for(var m=new Date(e.startDate).getTime(),g=Math.round((p-m)/a),v=Math.max(0,g),_=0,y=v;y<e.datapoints;y++){var b=new Date(p.valueOf()+(y-g)*a);d[y-v]=[b.getTime(),e.usages[y]],parseInt(e.usages[y])>_&&(_=e.usages[y])}if(0===d.length&&(d[0]=[p.getTime(),0]),d.length<u)for(y=d.length;u>y;y++)b=new Date(d[y-1][0]+1*a),d[y]=[b.getTime(),0];c.series[0].data=d,usageVisualizationCharts=new Highcharts.Chart(c),_>.95*i&&(usageVisualizationCharts.addSeries({name:"Recommended maximum daily usage based on your annual capacity",data:[[p.getTime(),i],[f.getTime(),i]],marker:{enabled:!1},enableMouseTracking:!1,type:"line",color:"rgba(0,0,0,0.7)",dashStyle:"shortdot",events:{legendItemClick:function(){return!1}}}),usageVisualizationCharts.addSeries({name:"",data:[[f.getTime(),1.2*_]],marker:{enabled:!1},enableMouseTracking:!1,type:"line",color:"rgba(0,0,0,0)",showInLegend:!1,events:{legendItemClick:function(){return!1}},visible:!0}))}function r(t,n,i){var r=0,a=3e6,s=0,o=0,l=0;void 0!==i&&void 0!==i.userType&&(r=parseInt(i.userType)),void 0!==i&&void 0!==i.number_of_messages_per_unit&&(a=parseInt(i.number_of_messages_per_unit)),void 0!==i&&void 0!==i.display_recommended_units&&(s=parseInt(i.display_recommended_units)),void 0!==i&&void 0!==i.proposed_num_of_units&&(o=parseInt(i.proposed_num_of_units),l=1);var u={};if(u.Date=new Date((new Date).setFullYear((new Date).getFullYear()+1)),u.DateType="Expiration Date",u.DailyUsageRate=0,void 0===n||void 0===n.usages||0===n.usages.length)return u;if(void 0===t||void 0===t.units||0===t.units.length)return u;for(var h=new Date("2016-12-05"),c=0;c<t.units.length;c++)if(t.units[c].qty>0&&void 0!==t.units[c].endDate&&new Date(t.units[c].endDate)>h){var d=Date.UTC(t.units[c].endDate.split("-")[0],t.units[c].endDate.split("-")[1]-1,t.units[c].endDate.split("-")[2]);h=new Date(d+60*new Date(Date.now()).getTimezoneOffset()*1e3)}for(var f=new Date,p=f.getDate(),m=0,c=1;p>c;c++)m+=parseInt(n.usages[n.usages.length-c]);for(var g=e(t,a),v=g[0],_=g[1]+m,y=v-_,b=0,w=0,T=0,$=0,c=1;31>c;c++)b+=parseInt(n.usages[n.usages.length-c]),16>c&&(w+=parseInt(n.usages[n.usages.length-c])),8>c&&(T+=parseInt(n.usages[n.usages.length-c])),2>c&&($+=parseInt(n.usages[n.usages.length-c]));var x=Math.ceil(b/30),S=Math.ceil(w/15),E=Math.ceil(T/7),D=$,k=1e-6;0==x&&(x=k),0==S&&(S=k),0==E&&(E=k),0==D&&(D=k);var R=Math.floor(y/x),C=Math.floor(y/S),A=Math.floor(y/E),M=Math.floor(y/D);R>365&&(R=365),C>365&&(C=365),A>365&&(A=365),M>365&&(M=365);var O=(new Date).getTime(),U=864e5,I=new Date(O+R*U),N=x;return 15*S>y&&(I=new Date(O+C*U),N=S),7*E>y&&(I=new Date(O+A*U),N=E),D>y&&(I=new Date(O+M*U),N=D),(f>I||0>y)&&(I=f),I>h||h.getFullYear()==I.getFullYear()&&h.getMonth()==I.getMonth()&&h.getDate()==I.getDate()?(u.Date=h,u.DateType="Expiration Date"):(u.Date=I,u.DateType="Exhaustion Date"),u.DailyUsageRate=Math.round(N),u}var a=864e5,s=[[0,114,189],[217,83,25],[237,177,32],[126,47,142],[119,172,48],[77,190,238],[162,20,47]],o=[["01",31],["02",28],["03",31],["04",30],["05",31],["06",30],["07",31],["08",31],["09",30],["10",31],["11",30],["12",31]],l=14,u=32;return{updateDailyUsageChart:i,updateMonthlyUsageChart:n,estimateExhaustionOrExpirationDate:r}}(),$(document).on("page:load ready",function(){if(0!==$("#sales_table").length){var e;e=user_info.is_free_user?user_info.free_license_id:user_info.is_a_staff?user_info.staff_license_id:$("#select_license").is("label")?$("#select_license").html():$("#select_license").val(),loadAccountsPage(e),$("#select_license").change(function(){loadAccountsPage($("#select_license").val())}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(){usageVisualizationCharts&&usageVisualizationCharts.reflow();var e,t=/(width: )\w+/,n=document.getElementById("myTabContent").offsetWidth-50,i=$(".highcharts-container").attr("style");void 0!==i&&(e=i.replace(t,"width: "+n+"px"),$(".highcharts-container").attr("style",e));var i=$(".highcharts-loading").attr("style");void 0!==i&&(e=i.replace(t,"width: "+n+"px"),$(".highcharts-loading").attr("style",e))})}});var formatToLocale=function(e){return e=isNaN(parseInt(e))?"":e.toLocaleString()},loadAccountsPage=function(e){if(setExhaustionAlertDefaults(),1==user_info.is_free_user){1==user_info.has_exhausted&&(is_shutOff=!0),$(".admin_div").hide(),$(".leu_div").hide(),$(".nde_leu_div").hide(),$(".nde_admin_div").hide(),$(".free_user_div").show(),$(".staff_div").hide();var t,n,i;if(jQuery.isEmptyObject(user_info.licenses)){var r="<tr><td>"+formatToLocale(Math.round(user_info.free_messages_per_year))+'</td><td colspan="2"><span class="text-danger break-word">'+rI18n.license_details_tmp_unavail+"</span></td></tr>";$("#free_user_messages_table").append(r)}else{expirationDate=new Date(Date.UTC(user_info.licenses[0].end_date.split("-")[0],user_info.licenses[0].end_date.split("-")[1]-1,user_info.licenses[0].end_date.split("-")[2])),t=user_info.licenses[0].end_date.split("-")[2],n=expirationDate.toLocaleString("en-us",{month:"short"}),i=user_info.licenses[0].end_date.split("-")[0],messagesRemaining=user_info.licenses[0].messages_remaining;var r="<tr><td>"+formatToLocale(Math.round(user_info.free_messages_per_year))+"</td><td>"+formatToLocale(messagesRemaining)+"</td><td>"+(t+" "+n+" "+i)+"</td></tr>";$("#free_user_messages_table").append(r)}$("#suggested_daily_usage_rate_free_user").html("&nbsp;"+formatToLocale(Math.round(user_info.free_messages_per_year/365))+"&nbsp;messages"),populateFreeUnitsLink()}else $(".free_user_div").hide(),jQuery.isEmptyObject(user_info.licenses)?($(".admin_div").hide(),$(".leu_div").hide(),$(".nde_leu_div").hide(),$(".nde_admin_div").hide(),$(".staff_div").hide(),$(".license_info_unavail_div").show()):user_info.licenses.forEach(function(t){if(t.license_id==e){if(null!=t.has_exhausted&&(is_shutOff=!0),1==t.is_an_leu){is_leu=!0,1==t.is_an_nde_leu?($(".admin_div").hide(),$(".leu_div").hide(),$(".nde_admin_div").hide(),$(".nde_leu_div").show(),$(".staff_div").hide()):t.is_a_staff?($(".admin_div").hide(),$(".nde_leu_div").hide(),$(".nde_admin_div").hide(),$(".leu_div").hide(),$(".staff_div").show()):($(".admin_div").hide(),$(".nde_leu_div").hide(),$(".nde_admin_div").hide(),$(".leu_div").show(),$(".staff_div").hide());var n=!1;user_info.licenses.forEach(function(e){0==e.is_an_leu&&(n=!0)}),n?$(".pricing_link").hide():$(".pricing_link").show()}else 1==t.is_an_nde_admin?($(".admin_div").hide(),$(".leu_div").hide(),$(".nde_leu_div").hide(),$(".staff_div").hide(),$(".nde_admin_div").show()):($(".leu_div").hide(),$(".nde_leu_div").hide(),$(".nde_admin_div").hide(),$(".staff_div").hide(),$(".admin_div").show()),drawUnitsTable(t,e),populatePurchaseUnitsLink(e);populateAlertMessages(e,is_shutOff)}});drawMessageUsageCharts(e),populateLicenceCenterLink(e)},drawUnitsTable=function(e,t){e.is_an_nde_admin?(sales_table=$("#sales_table_nde"),suggested_daily_rate=$("#suggested_daily_usage_rate_nde")):(sales_table=$("#sales_table"),suggested_daily_rate=$("#suggested_daily_usage_rate")),sales_table.find("tbody > tr").remove();var n=[],i=0;user_info.licenses.forEach(function(e){return e.license_id==t?(i+=1,n=e.units,!1):void 0});var r,a,s,o,l,u,h=0,c=[],d=[[0,114,189],[217,83,25],[237,177,32],[126,47,142],[119,172,48],[77,190,238],[162,20,47]],f=0,p=0,m=new Date(1970,1,1),g=new Date(1970,1,1);n.forEach(function(e){expirationDateUTC=Date.UTC(e.end_date.split("-")[0],e.end_date.split("-")[1]-1,e.end_date.split("-")[2]),r=new Date(expirationDateUTC+60*new Date(Date.now()).getTimezoneOffset()*1e3),a=(r.getDate()<10?"0":"")+r.getDate(),s=r.toLocaleString("en-us",{month:"short"}),o=r.getFullYear(),u=e.messages_allowed,messagesRemaining=e.messages_remaining,h+=messagesRemaining;var t="rgba("+d[f][0]+","+d[f][1]+","+d[f][2]+",1)";l="<tr><td>"+e.qty+"</td><td>"+formatToLocale(e.messages_allowed)+"</td><td>"+formatToLocale(e.messages_remaining)+"</td><td>"+(a+" "+s+" "+o)+'&nbsp;<i class="fa fa-square units_box" style=color:'+t+' aria-hidden="true"></i></td></tr>',f=(f+1)%d.length,r>new Date?(sales_table.append(l),r>g&&(g=r)):(p+=1,r>m&&(m=r,trHTMLMAX=l),p===n.length&&sales_table.append(trHTMLMAX)),checkForLicenseProdId(c,e,r)
}),c.forEach(function(e){checkForUnitExpiration(e)});var v=Math.abs((new Date).getTime()-g.getTime()),_=Math.ceil(v/864e5);user_info.suggestedDailyRate=Math.round(h/_),suggested_daily_rate.html("&nbsp;"+formatToLocale(user_info.suggestedDailyRate)+"&nbsp;messages")},checkForLicenseProdId=function(e,t,n){e.push({key:t,value:n});for(var i in e)e[i].key.licensed_prod_id===t.licensed_prod_id&&1!=e.length&&e[i].key.id!=t.id&&checkDateForRenewal(e[i],n,e,i)},checkDateForRenewal=function(e,t,n,i){e.value<t?n.splice(i,1):n.splice(-1,1)},checkForUnitExpiration=function(e){var t=Math.abs(new Date(e.value).getTime()-(new Date).getTime()),n=Math.ceil(t/864e5),i=e.value.toISOString().split("T")[0]===(new Date).toISOString().split("T")[0];(e.value>new Date||i)&&60>=n&&renderRenewalsDiv(e)},renderRenewalsDiv=function(e){$("#purchase_units_link").addClass("btn-default"),$("#renew_units_link").show();var t='<div id="'+e.key.id+'renewals_div" class="alert alert-danger alert-dismissable renewals_expiration_alert" style="display:none; clear:both"><a href="#" class="close" data-dismiss="alert" aria-label="close">X</a><span>User purchase made on <strong><span name="renewal_start_date" id="'+e.key.id+'renewal_start_date"></span></strong> is going to expire on: <strong><span name="renewal_expiration_date" id="'+e.key.id+'renewal_expiration_date"></span></strong>.<i class="fa fa-exclamation-triangle" aria-hidden="true"></i><a id="'+e.key.id+'call_of_action_to_renew" class="exhaustion_alert" target="_blank">Renew units</a></span></div>';$("#exhaustion_div").append(t),$("#"+e.key.id+"renewal_start_date").text(moment(new Date(e.key.start_date)).format("LL")),$("#"+e.key.id+"renewal_expiration_date").text(moment(new Date(e.value)).format("LL")),populateRenewUnitsLink(e.key.id),$("#"+e.key.id+"renewals_div").show()},drawMessageUsageCharts=function(e){$("#spinner_daily").show(),$("#spinner_monthly").show();var t=!1,n=0;user_info.is_free_user||jQuery.isEmptyObject(user_info.licenses)||user_info.licenses.forEach(function(i){i.license_id==e&&(t=i.is_an_leu,n=i.total_remaining_messages_per_license)});var i={daily:void 0,monthly:void 0},r={userType:user_info.user_type};user_info.is_free_user?(r.number_of_messages_per_unit=user_info.free_messages_per_year,r.messages_remaining=user_info.licenses[0].messages_remaining):(r.number_of_messages_per_unit=user_info.messages_per_paid_unit,r.messages_remaining=n);var a=function(e){i.daily=e,o(i),$("#spinner_daily").hide(),UsageVisualizations.updateDailyUsageChart(e,"dailyMessageUsage",r,user_info.suggestedDailyRate)},s=function(e){i.monthly=e,o(i),$("#monthly_usage_tab").is(":visible")&&($("#spinner_monthly").hide(),UsageVisualizations.updateMonthlyUsageChart(e,"messageUnitUsage",r))},o=function(t){t.daily&&t.monthly&&checkMessageExhaustion(e,user_info,user_info.is_free_user,i,!0,r)},l=5e3,u={url:"/account/daily_usage.json",cache:!1,data:{lid:e,is_an_leu:t},dataType:"json",timeout:l};$.ajax(u).done(a).fail(function(e){304!=e.status?$.ajax(u).done(a).fail(function(){$("#spinner_daily").hide(),$("#dailyMessageUsageTmpUnavail").show()}):($("#spinner_daily").hide(),$("#dailyMessageUsageTmpUnavail").show())}),monthlyAjaxOptions={url:"/account/monthly_usage.json",cache:!1,data:{lid:e,is_an_leu:t},dataType:"json",timeout:l},$.ajax(monthlyAjaxOptions).done(s).fail(function(e){304!=e.status?$.ajax(monthlyAjaxOptions).done(s).fail(function(){$("#spinner_monthly").hide(),$("#messageUnitUsageTmpUnavail").show()}):($("#spinner_monthly").hide(),$("#messageUnitUsageTmpUnavail").show())})},populateLicenceCenterLink=function(e){var t=user_info.license_center_link;t=t.replace(":lid",encodeURIComponent(e)),$("#license_center_link").attr("href",t)},populateRenewUnitsLink=function(e){var t=user_info.licenses[user_info.licenses.length-1].license_id;renew_link=renew_units_link.replace(":lid",encodeURIComponent(t)),$("#"+e+"call_of_action_to_renew").attr("href",renew_link),$("#renew_units_link").attr("href",renew_link)};!function(e,t){"function"==typeof define&&define.amd?define(["exports"],t):t("object"==typeof exports&&"string"!=typeof exports.nodeName?module.exports:e)}(this,function(e){function t(e,t,n){null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function n(){return new t(null)}function i(e,t,n,i,r,a){for(;--a>=0;){var s=t*this[e++]+n[i]+r;r=Math.floor(s/67108864),n[i++]=67108863&s}return r}function r(e,t,n,i,r,a){for(var s=32767&t,o=t>>15;--a>=0;){var l=32767&this[e],u=this[e++]>>15,h=o*l+u*s;l=s*l+((32767&h)<<15)+n[i]+(1073741823&r),r=(l>>>30)+(h>>>15)+o*u+(r>>>30),n[i++]=1073741823&l}return r}function a(e,t,n,i,r,a){for(var s=16383&t,o=t>>14;--a>=0;){var l=16383&this[e],u=this[e++]>>14,h=o*l+u*s;l=s*l+((16383&h)<<14)+n[i]+r,r=(l>>28)+(h>>14)+o*u,n[i++]=268435455&l}return r}function s(e){return kn.charAt(e)}function o(e,t){var n=Rn[e.charCodeAt(t)];return null==n?-1:n}function l(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function u(e){this.t=1,this.s=0>e?-1:0,e>0?this[0]=e:-1>e?this[0]=e+this.DV:this.t=0}function h(e){var t=n();return t.fromInt(e),t}function c(e,n){var i;if(16==n)i=4;else if(8==n)i=3;else if(256==n)i=8;else if(2==n)i=1;else if(32==n)i=5;else{if(4!=n)return void this.fromRadix(e,n);i=2}this.t=0,this.s=0;for(var r=e.length,a=!1,s=0;--r>=0;){var l=8==i?255&e[r]:o(e,r);0>l?"-"==e.charAt(r)&&(a=!0):(a=!1,0==s?this[this.t++]=l:s+i>this.DB?(this[this.t-1]|=(l&(1<<this.DB-s)-1)<<s,this[this.t++]=l>>this.DB-s):this[this.t-1]|=l<<s,s+=i,s>=this.DB&&(s-=this.DB))}8==i&&0!=(128&e[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),a&&t.ZERO.subTo(this,this)}function d(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function f(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,i=(1<<t)-1,r=!1,a="",o=this.t,l=this.DB-o*this.DB%t;if(o-->0)for(l<this.DB&&(n=this[o]>>l)>0&&(r=!0,a=s(n));o>=0;)t>l?(n=(this[o]&(1<<l)-1)<<t-l,n|=this[--o]>>(l+=this.DB-t)):(n=this[o]>>(l-=t)&i,0>=l&&(l+=this.DB,--o)),n>0&&(r=!0),r&&(a+=s(n));return r?a:"0"}function p(){var e=n();return t.ZERO.subTo(this,e),e}function m(){return this.s<0?this.negate():this}function g(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(t=n-e.t,0!=t)return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0}function _(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function y(){return this.t<=0?0:this.DB*(this.t-1)+_(this[this.t-1]^this.s&this.DM)}function b(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function w(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function T(e,t){var n,i=e%this.DB,r=this.DB-i,a=(1<<r)-1,s=Math.floor(e/this.DB),o=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)t[n+s+1]=this[n]>>r|o,o=(this[n]&a)<<i;for(n=s-1;n>=0;--n)t[n]=0;t[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function $(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)return void(t.t=0);var i=e%this.DB,r=this.DB-i,a=(1<<i)-1;t[0]=this[n]>>i;for(var s=n+1;s<this.t;++s)t[s-n-1]|=(this[s]&a)<<r,t[s-n]=this[s]>>i;i>0&&(t[this.t-n-1]|=(this.s&a)<<r),t.t=this.t-n,t.clamp()}function x(e,t){for(var n=0,i=0,r=Math.min(e.t,this.t);r>n;)i+=this[n]-e[n],t[n++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;n<this.t;)i+=this[n],t[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<e.t;)i-=e[n],t[n++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=0>i?-1:0,-1>i?t[n++]=this.DV+i:i>0&&(t[n++]=i),t.t=n,t.clamp()}function S(e,n){var i=this.abs(),r=e.abs(),a=i.t;for(n.t=a+r.t;--a>=0;)n[a]=0;for(a=0;a<r.t;++a)n[a+i.t]=i.am(0,r[a],n,a,0,i.t);n.s=0,n.clamp(),this.s!=e.s&&t.ZERO.subTo(n,n)}function E(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){var i=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,i,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function D(e,i,r){var a=e.abs();if(!(a.t<=0)){var s=this.abs();if(s.t<a.t)return null!=i&&i.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=n());var o=n(),l=this.s,u=e.s,h=this.DB-_(a[a.t-1]);h>0?(a.lShiftTo(h,o),s.lShiftTo(h,r)):(a.copyTo(o),s.copyTo(r));var c=o.t,d=o[c-1];if(0!=d){var f=d*(1<<this.F1)+(c>1?o[c-2]>>this.F2:0),p=this.FV/f,m=(1<<this.F1)/f,g=1<<this.F2,v=r.t,y=v-c,b=null==i?n():i;for(o.dlShiftTo(y,b),r.compareTo(b)>=0&&(r[r.t++]=1,r.subTo(b,r)),t.ONE.dlShiftTo(c,b),b.subTo(o,o);o.t<c;)o[o.t++]=0;for(;--y>=0;){var w=r[--v]==d?this.DM:Math.floor(r[v]*p+(r[v-1]+g)*m);if((r[v]+=o.am(0,w,r,y,0,c))<w)for(o.dlShiftTo(y,b),r.subTo(b,r);r[v]<--w;)r.subTo(b,r)}null!=i&&(r.drShiftTo(c,i),l!=u&&t.ZERO.subTo(i,i)),r.t=c,r.clamp(),h>0&&r.rShiftTo(h,r),0>l&&t.ZERO.subTo(r,r)}}}function k(e){var i=n();return this.abs().divRemTo(e,null,i),this.s<0&&i.compareTo(t.ZERO)>0&&e.subTo(i,i),i}function R(e){this.m=e}function C(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function A(e){return e}function M(e){e.divRemTo(this.m,null,e)}function O(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function U(e,t){e.squareTo(t),this.reduce(t)}function I(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return t=t*(2-(15&e)*t)&15,t=t*(2-(255&e)*t)&255,t=t*(2-((65535&e)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function N(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function L(e){var i=n();return e.abs().dlShiftTo(this.m.t,i),i.divRemTo(this.m,null,i),e.s<0&&i.compareTo(t.ZERO)>0&&this.m.subTo(i,i),i}function P(e){var t=n();return e.copyTo(t),this.reduce(t),t}function q(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e[t],i=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,i,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function B(e,t){e.squareTo(t),this.reduce(t)}function F(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function V(){return 0==(this.t>0?1&this[0]:this.s)}function j(e,i){if(e>4294967295||1>e)return t.ONE;var r=n(),a=n(),s=i.convert(this),o=_(e)-1;for(s.copyTo(r);--o>=0;)if(i.sqrTo(r,a),(e&1<<o)>0)i.mulTo(a,s,r);else{var l=r;r=a,a=l}return i.revert(r)}function H(e,t){var n;return n=256>e||t.isEven()?new R(t):new N(t),this.exp(e,n)}function K(){var e=n();return this.copyTo(e),e}function J(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function z(){return 0==this.t?this.s:this[0]<<24>>24}function Y(){return 0==this.t?this.s:this[0]<<16>>16}function G(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function X(e){if(null==e&&(e=10),0==this.signum()||2>e||e>36)return"0";var t=this.chunkSize(e),i=Math.pow(e,t),r=h(i),a=n(),s=n(),o="";for(this.divRemTo(r,a,s);a.signum()>0;)o=(i+s.intValue()).toString(e).substr(1)+o,a.divRemTo(r,a,s);return s.intValue().toString(e)+o}function Q(e,n){this.fromInt(0),null==n&&(n=10);for(var i=this.chunkSize(n),r=Math.pow(n,i),a=!1,s=0,l=0,u=0;u<e.length;++u){var h=o(e,u);0>h?"-"==e.charAt(u)&&0==this.signum()&&(a=!0):(l=n*l+h,++s>=i&&(this.dMultiply(r),this.dAddOffset(l,0),s=0,l=0))}s>0&&(this.dMultiply(Math.pow(n,s)),this.dAddOffset(l,0)),a&&t.ZERO.subTo(this,this)}function Z(e,n,i){if("number"==typeof n)if(2>e)this.fromInt(1);else for(this.fromNumber(e,i),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),ot,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(n);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(t.ONE.shiftLeft(e-1),this);else{var r=new Array,a=7&e;r.length=(e>>3)+1,n.nextBytes(r),a>0?r[0]&=(1<<a)-1:r[0]=0,this.fromString(r,256)}}function et(){var e=this.t,t=new Array;t[0]=this.s;var n,i=this.DB-e*this.DB%8,r=0;if(e-->0)for(i<this.DB&&(n=this[e]>>i)!=(this.s&this.DM)>>i&&(t[r++]=n|this.s<<this.DB-i);e>=0;)8>i?(n=(this[e]&(1<<i)-1)<<8-i,n|=this[--e]>>(i+=this.DB-8)):(n=this[e]>>(i-=8)&255,0>=i&&(i+=this.DB,--e)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(t[r++]=n);return t}function tt(e){return 0==this.compareTo(e)}function nt(e){return this.compareTo(e)<0?this:e}function it(e){return this.compareTo(e)>0?this:e}function rt(e,t,n){var i,r,a=Math.min(e.t,this.t);for(i=0;a>i;++i)n[i]=t(this[i],e[i]);if(e.t<this.t){for(r=e.s&this.DM,i=a;i<this.t;++i)n[i]=t(this[i],r);n.t=this.t}else{for(r=this.s&this.DM,i=a;i<e.t;++i)n[i]=t(r,e[i]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()}function at(e,t){return e&t}function st(e){var t=n();return this.bitwiseTo(e,at,t),t}function ot(e,t){return e|t}function lt(e){var t=n();return this.bitwiseTo(e,ot,t),t}function ut(e,t){return e^t}function ht(e){var t=n();return this.bitwiseTo(e,ut,t),t}function ct(e,t){return e&~t}function dt(e){var t=n();return this.bitwiseTo(e,ct,t),t}function ft(){for(var e=n(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function pt(e){var t=n();return 0>e?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function mt(e){var t=n();return 0>e?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function gt(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function vt(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+gt(this[e]);return this.s<0?this.t*this.DB:-1}function _t(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function yt(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=_t(this[n]^t);return e}function bt(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)}function wt(e,n){var i=t.ONE.shiftLeft(e);return this.bitwiseTo(i,n,i),i}function Tt(e){return this.changeBit(e,ot)}function $t(e){return this.changeBit(e,ct)}function xt(e){return this.changeBit(e,ut)}function St(e,t){for(var n=0,i=0,r=Math.min(e.t,this.t);r>n;)i+=this[n]+e[n],t[n++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;n<this.t;)i+=this[n],t[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<e.t;)i+=e[n],t[n++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=0>i?-1:0,i>0?t[n++]=i:-1>i&&(t[n++]=this.DV+i),t.t=n,t.clamp()}function Et(e){var t=n();return this.addTo(e,t),t}function Dt(e){var t=n();return this.subTo(e,t),t}function kt(e){var t=n();return this.multiplyTo(e,t),t}function Rt(){var e=n();return this.squareTo(e),e}function Ct(e){var t=n();return this.divRemTo(e,t,null),t}function At(e){var t=n();return this.divRemTo(e,null,t),t}function Mt(e){var t=n(),i=n();return this.divRemTo(e,t,i),new Array(t,i)}function Ot(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Ut(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function It(){}function Nt(e){return e}function Lt(e,t,n){e.multiplyTo(t,n)}function Pt(e,t){e.squareTo(t)}function qt(e){return this.exp(e,new It)}function Bt(e,t,n){var i=Math.min(this.t+e.t,t);for(n.s=0,n.t=i;i>0;)n[--i]=0;var r;for(r=n.t-this.t;r>i;++i)n[i+this.t]=this.am(0,e[i],n,i,0,this.t);for(r=Math.min(e.t,t);r>i;++i)this.am(0,e[i],n,i,0,t-i);n.clamp()}function Ft(e,t,n){--t;var i=n.t=this.t+e.t-t;for(n.s=0;--i>=0;)n[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)n[this.t+i-t]=this.am(t-i,e[i],n,0,0,this.t+i-t);n.clamp(),n.drShiftTo(1,n)}function Vt(e){this.r2=n(),this.q3=n(),t.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function jt(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=n();return e.copyTo(t),this.reduce(t),t}function Ht(e){return e}function Kt(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Jt(e,t){e.squareTo(t),this.reduce(t)}function zt(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function Yt(e,t){var i,r,a=e.bitLength(),s=h(1);if(0>=a)return s;i=18>a?1:48>a?3:144>a?4:768>a?5:6,r=8>a?new R(t):t.isEven()?new Vt(t):new N(t);var o=new Array,l=3,u=i-1,c=(1<<i)-1;if(o[1]=r.convert(this),i>1){var d=n();for(r.sqrTo(o[1],d);c>=l;)o[l]=n(),r.mulTo(d,o[l-2],o[l]),l+=2}var f,p,m=e.t-1,g=!0,v=n();for(a=_(e[m])-1;m>=0;){for(a>=u?f=e[m]>>a-u&c:(f=(e[m]&(1<<a+1)-1)<<u-a,m>0&&(f|=e[m-1]>>this.DB+a-u)),l=i;0==(1&f);)f>>=1,--l;if((a-=l)<0&&(a+=this.DB,--m),g)o[f].copyTo(s),g=!1;else{for(;l>1;)r.sqrTo(s,v),r.sqrTo(v,s),l-=2;l>0?r.sqrTo(s,v):(p=s,s=v,v=p),r.mulTo(v,o[f],s)}for(;m>=0&&0==(e[m]&1<<a);)r.sqrTo(s,v),p=s,s=v,v=p,--a<0&&(a=this.DB-1,--m)}return r.revert(s)}function Gt(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var i=t;t=n,n=i}var r=t.getLowestSetBit(),a=n.getLowestSetBit();if(0>a)return t;for(a>r&&(a=r),a>0&&(t.rShiftTo(a,t),n.rShiftTo(a,n));t.signum()>0;)(r=t.getLowestSetBit())>0&&t.rShiftTo(r,t),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return a>0&&n.lShiftTo(a,n),n}function Wt(e){if(0>=e)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this[0]%e;else for(var i=this.t-1;i>=0;--i)n=(t*n+this[i])%e;return n}function Xt(e){var n=e.isEven();if(this.isEven()&&n||0==e.signum())return t.ZERO;for(var i=e.clone(),r=this.clone(),a=h(1),s=h(0),o=h(0),l=h(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),n?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(e,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),n?(o.isEven()&&l.isEven()||(o.addTo(this,o),l.subTo(e,l)),o.rShiftTo(1,o)):l.isEven()||l.subTo(e,l),l.rShiftTo(1,l);i.compareTo(r)>=0?(i.subTo(r,i),n&&a.subTo(o,a),s.subTo(l,s)):(r.subTo(i,r),n&&o.subTo(a,o),l.subTo(s,l))}return 0!=r.compareTo(t.ONE)?t.ZERO:l.compareTo(e)>=0?l.subtract(e):l.signum()<0?(l.addTo(e,l),l.signum()<0?l.add(e):l):l}function Qt(e){var t,n=this.abs();if(1==n.t&&n[0]<=Cn[Cn.length-1]){for(t=0;t<Cn.length;++t)if(n[0]==Cn[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<Cn.length;){for(var i=Cn[t],r=t+1;r<Cn.length&&An>i;)i*=Cn[r++];for(i=n.modInt(i);r>t;)if(i%Cn[t++]==0)return!1}return n.millerRabin(e)}function Zt(e){var i=this.subtract(t.ONE),r=i.getLowestSetBit();if(0>=r)return!1;var a=i.shiftRight(r);e=e+1>>1,e>Cn.length&&(e=Cn.length);for(var s=n(),o=0;e>o;++o){s.fromInt(Cn[Math.floor(Math.random()*Cn.length)]);var l=s.modPow(a,this);if(0!=l.compareTo(t.ONE)&&0!=l.compareTo(i)){for(var u=1;u++<r&&0!=l.compareTo(i);)if(l=l.modPowInt(2,this),0==l.compareTo(t.ONE))return!1;if(0!=l.compareTo(i))return!1}}return!0}function en(){this.i=0,this.j=0,this.S=new Array}function tn(e){var t,n,i;for(t=0;256>t;++t)this.S[t]=t;for(n=0,t=0;256>t;++t)n=n+this.S[t]+e[t%e.length]&255,i=this.S[t],this.S[t]=this.S[n],this.S[n]=i;this.i=0,this.j=0}function nn(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}function rn(){return new en}function an(){if(null==Mn){for(Mn=rn();In>Un;){var e=Math.floor(65536*Math.random());On[Un++]=255&e}for(Mn.init(On),Un=0;Un<On.length;++Un)On[Un]=0;Un=0}return Mn.next()}function sn(e){var t;for(t=0;t<e.length;++t)e[t]=an()}function on(){}function ln(e,n){return new t(e,n)}function un(e,n){if(n<e.length+11)return console.error("Message too long for RSA"),null;for(var i=new Array,r=e.length-1;r>=0&&n>0;){var a=e.charCodeAt(r--);128>a?i[--n]=a:a>127&&2048>a?(i[--n]=63&a|128,i[--n]=a>>6|192):(i[--n]=63&a|128,i[--n]=a>>6&63|128,i[--n]=a>>12|224)}i[--n]=0;for(var s=new on,o=new Array;n>2;){for(o[0]=0;0==o[0];)s.nextBytes(o);i[--n]=o[0]}return i[--n]=2,i[--n]=0,new t(i)}function hn(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function cn(e,t){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=ln(e,16),this.e=parseInt(t,16)):console.error("Invalid RSA public key")}function dn(e){return e.modPowInt(this.e,this.n)}function fn(e){var t=un(e,this.n.bitLength()+7>>3);if(null==t)return null;var n=this.doPublic(t);if(null==n)return null;var i=n.toString(16);return 0==(1&i.length)?i:"0"+i}function pn(e,t){for(var n=e.toByteArray(),i=0;i<n.length&&0==n[i];)++i;if(n.length-i!=t-1||2!=n[i])return null;for(++i;0!=n[i];)if(++i>=n.length)return null;for(var r="";++i<n.length;){var a=255&n[i];128>a?r+=String.fromCharCode(a):a>191&&224>a?(r+=String.fromCharCode((31&a)<<6|63&n[i+1]),++i):(r+=String.fromCharCode((15&a)<<12|(63&n[i+1])<<6|63&n[i+2]),i+=2)}return r}function mn(e,t,n){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=ln(e,16),this.e=parseInt(t,16),this.d=ln(n,16)):console.error("Invalid RSA private key")}function gn(e,t,n,i,r,a,s,o){null!=e&&null!=t&&e.length>0&&t.length>0?(this.n=ln(e,16),this.e=parseInt(t,16),this.d=ln(n,16),this.p=ln(i,16),this.q=ln(r,16),this.dmp1=ln(a,16),this.dmq1=ln(s,16),this.coeff=ln(o,16)):console.error("Invalid RSA private key")}function vn(e,n){var i=new on,r=e>>1;this.e=parseInt(n,16);for(var a=new t(n,16);;){for(;this.p=new t(e-r,1,i),0!=this.p.subtract(t.ONE).gcd(a).compareTo(t.ONE)||!this.p.isProbablePrime(10););for(;this.q=new t(r,1,i),0!=this.q.subtract(t.ONE).gcd(a).compareTo(t.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(t.ONE),l=this.q.subtract(t.ONE),u=o.multiply(l);if(0==u.gcd(a).compareTo(t.ONE)){this.n=this.p.multiply(this.q),this.d=a.modInverse(u),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(l),this.coeff=this.q.modInverse(this.p);break}}}function _n(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),n=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(n)<0;)t=t.add(this.p);return t.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)}function yn(e){var t=ln(e,16),n=this.doPrivate(t);return null==n?null:pn(n,this.n.bitLength()+7>>3)}function bn(e){var t,n,i="";for(t=0;t+3<=e.length;t+=3)n=parseInt(e.substring(t,t+3),16),i+=qn.charAt(n>>6)+qn.charAt(63&n);for(t+1==e.length?(n=parseInt(e.substring(t,t+1),16),i+=qn.charAt(n<<2)):t+2==e.length&&(n=parseInt(e.substring(t,t+2),16),i+=qn.charAt(n>>2)+qn.charAt((3&n)<<4));(3&i.length)>0;)i+=Bn;return i}function wn(e){var t,n,i="",r=0;for(t=0;t<e.length&&e.charAt(t)!=Bn;++t)v=qn.indexOf(e.charAt(t)),v<0||(0==r?(i+=s(v>>2),n=3&v,r=1):1==r?(i+=s(n<<2|v>>4),n=15&v,r=2):2==r?(i+=s(n),i+=s(v>>2),n=3&v,r=3):(i+=s(n<<2|v>>4),i+=s(15&v),r=0));return 1==r&&(i+=s(n<<2)),i}var Tn,$n=0xdeadbeefcafe,xn=15715070==(16777215&$n);xn&&"Microsoft Internet Explorer"==navigator.appName?(t.prototype.am=r,Tn=30):xn&&"Netscape"!=navigator.appName?(t.prototype.am=i,Tn=26):(t.prototype.am=a,Tn=28),t.prototype.DB=Tn,t.prototype.DM=(1<<Tn)-1,t.prototype.DV=1<<Tn;var Sn=52;t.prototype.FV=Math.pow(2,Sn),t.prototype.F1=Sn-Tn,t.prototype.F2=2*Tn-Sn;var En,Dn,kn="0123456789abcdefghijklmnopqrstuvwxyz",Rn=new Array;for(En="0".charCodeAt(0),Dn=0;9>=Dn;++Dn)Rn[En++]=Dn;for(En="a".charCodeAt(0),Dn=10;36>Dn;++Dn)Rn[En++]=Dn;for(En="A".charCodeAt(0),Dn=10;36>Dn;++Dn)Rn[En++]=Dn;R.prototype.convert=C,R.prototype.revert=A,R.prototype.reduce=M,R.prototype.mulTo=O,R.prototype.sqrTo=U,N.prototype.convert=L,N.prototype.revert=P,N.prototype.reduce=q,N.prototype.mulTo=F,N.prototype.sqrTo=B,t.prototype.copyTo=l,t.prototype.fromInt=u,t.prototype.fromString=c,t.prototype.clamp=d,t.prototype.dlShiftTo=b,t.prototype.drShiftTo=w,t.prototype.lShiftTo=T,t.prototype.rShiftTo=$,t.prototype.subTo=x,t.prototype.multiplyTo=S,t.prototype.squareTo=E,t.prototype.divRemTo=D,t.prototype.invDigit=I,t.prototype.isEven=V,t.prototype.exp=j,t.prototype.toString=f,t.prototype.negate=p,t.prototype.abs=m,t.prototype.compareTo=g,t.prototype.bitLength=y,t.prototype.mod=k,t.prototype.modPowInt=H,t.ZERO=h(0),t.ONE=h(1),It.prototype.convert=Nt,It.prototype.revert=Nt,It.prototype.mulTo=Lt,It.prototype.sqrTo=Pt,Vt.prototype.convert=jt,Vt.prototype.revert=Ht,Vt.prototype.reduce=Kt,Vt.prototype.mulTo=zt,Vt.prototype.sqrTo=Jt;var Cn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],An=(1<<26)/Cn[Cn.length-1];t.prototype.chunkSize=G,t.prototype.toRadix=X,t.prototype.fromRadix=Q,t.prototype.fromNumber=Z,t.prototype.bitwiseTo=rt,t.prototype.changeBit=wt,t.prototype.addTo=St,t.prototype.dMultiply=Ot,t.prototype.dAddOffset=Ut,t.prototype.multiplyLowerTo=Bt,t.prototype.multiplyUpperTo=Ft,t.prototype.modInt=Wt,t.prototype.millerRabin=Zt,t.prototype.clone=K,t.prototype.intValue=J,t.prototype.byteValue=z,t.prototype.shortValue=Y,t.prototype.signum=W,t.prototype.toByteArray=et,t.prototype.equals=tt,t.prototype.min=nt,t.prototype.max=it,t.prototype.and=st,t.prototype.or=lt,t.prototype.xor=ht,t.prototype.andNot=dt,t.prototype.not=ft,t.prototype.shiftLeft=pt,t.prototype.shiftRight=mt,t.prototype.getLowestSetBit=vt,t.prototype.bitCount=yt,t.prototype.testBit=bt,t.prototype.setBit=Tt,t.prototype.clearBit=$t,t.prototype.flipBit=xt,t.prototype.add=Et,t.prototype.subtract=Dt,t.prototype.multiply=kt,t.prototype.divide=Ct,t.prototype.remainder=At,t.prototype.divideAndRemainder=Mt,t.prototype.modPow=Yt,t.prototype.modInverse=Xt,t.prototype.pow=qt,t.prototype.gcd=Gt,t.prototype.isProbablePrime=Qt,t.prototype.square=Rt,en.prototype.init=tn,en.prototype.next=nn;var Mn,On,Un,In=256;if(null==On){On=new Array,Un=0;var Nn;if(window.crypto&&window.crypto.getRandomValues){var Ln=new Uint32Array(256);for(window.crypto.getRandomValues(Ln),Nn=0;Nn<Ln.length;++Nn)On[Un++]=255&Ln[Nn]}var Pn=function(e){if(this.count=this.count||0,this.count>=256||Un>=In)return void(window.removeEventListener?window.removeEventListener("mousemove",Pn,!1):window.detachEvent&&window.detachEvent("onmousemove",Pn));try{var t=e.x+e.y;On[Un++]=255&t,this.count+=1}catch(n){}};window.addEventListener?window.addEventListener("mousemove",Pn,!1):window.attachEvent&&window.attachEvent("onmousemove",Pn)}on.prototype.nextBytes=sn,hn.prototype.doPublic=dn,hn.prototype.setPublic=cn,hn.prototype.encrypt=fn,hn.prototype.doPrivate=_n,hn.prototype.setPrivate=mn,hn.prototype.setPrivateEx=gn,hn.prototype.generate=vn,hn.prototype.decrypt=yn,function(){var e=function(e,i,r){var a=new on,s=e>>1;this.e=parseInt(i,16);var o=new t(i,16),l=this,u=function(){var i=function(){if(l.p.compareTo(l.q)<=0){var e=l.p;l.p=l.q,l.q=e}var n=l.p.subtract(t.ONE),i=l.q.subtract(t.ONE),a=n.multiply(i);0==a.gcd(o).compareTo(t.ONE)?(l.n=l.p.multiply(l.q),l.d=o.modInverse(a),l.dmp1=l.d.mod(n),l.dmq1=l.d.mod(i),l.coeff=l.q.modInverse(l.p),setTimeout(function(){r()},0)):setTimeout(u,0)},h=function(){l.q=n(),l.q.fromNumberAsync(s,1,a,function(){l.q.subtract(t.ONE).gcda(o,function(e){0==e.compareTo(t.ONE)&&l.q.isProbablePrime(10)?setTimeout(i,0):setTimeout(h,0)})})},c=function(){l.p=n(),l.p.fromNumberAsync(e-s,1,a,function(){l.p.subtract(t.ONE).gcda(o,function(e){0==e.compareTo(t.ONE)&&l.p.isProbablePrime(10)?setTimeout(h,0):setTimeout(c,0)})})};setTimeout(c,0)};setTimeout(u,0)};hn.prototype.generateAsync=e;var i=function(e,t){var n=this.s<0?this.negate():this.clone(),i=e.s<0?e.negate():e.clone();if(n.compareTo(i)<0){var r=n;n=i,i=r}var a=n.getLowestSetBit(),s=i.getLowestSetBit();if(0>s)return void t(n);s>a&&(s=a),s>0&&(n.rShiftTo(s,n),i.rShiftTo(s,i));var o=function(){(a=n.getLowestSetBit())>0&&n.rShiftTo(a,n),(a=i.getLowestSetBit())>0&&i.rShiftTo(a,i),n.compareTo(i)>=0?(n.subTo(i,n),n.rShiftTo(1,n)):(i.subTo(n,i),i.rShiftTo(1,i)),n.signum()>0?setTimeout(o,0):(s>0&&i.lShiftTo(s,i),setTimeout(function(){t(i)},0))};setTimeout(o,10)};t.prototype.gcda=i;var r=function(e,n,i,r){if("number"==typeof n)if(2>e)this.fromInt(1);else{this.fromNumber(e,i),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),ot,this),this.isEven()&&this.dAddOffset(1,0);var a=this,s=function(){a.dAddOffset(2,0),a.bitLength()>e&&a.subTo(t.ONE.shiftLeft(e-1),a),a.isProbablePrime(n)?setTimeout(function(){r()},0):setTimeout(s,0)};setTimeout(s,0)}else{var o=new Array,l=7&e;o.length=(e>>3)+1,n.nextBytes(o),l>0?o[0]&=(1<<l)-1:o[0]=0,this.fromString(o,256)}};t.prototype.fromNumberAsync=r}();var qn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bn="=",Fn=Fn||{};Fn.env=Fn.env||{};var Vn=Fn,jn=Object.prototype,Hn="[object Function]",Kn=["toString","valueOf"];Fn.env.parseUA=function(e){var t,n=function(e){var t=0;return parseFloat(e.replace(/\./g,function(){return 1==t++?"":"."}))},i=navigator,r={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:i&&i.cajaVersion,secure:!1,os:null},a=e||navigator&&navigator.userAgent,s=window&&window.location,o=s&&s.href;return r.secure=o&&0===o.toLowerCase().indexOf("https"),a&&(/windows|win32/i.test(a)?r.os="windows":/macintosh/i.test(a)?r.os="macintosh":/rhino/i.test(a)&&(r.os="rhino"),/KHTML/.test(a)&&(r.webkit=1),t=a.match(/AppleWebKit\/([^\s]*)/),t&&t[1]&&(r.webkit=n(t[1]),/ Mobile\//.test(a)?(r.mobile="Apple",t=a.match(/OS ([^\s]*)/),t&&t[1]&&(t=n(t[1].replace("_","."))),r.ios=t,r.ipad=r.ipod=r.iphone=0,t=a.match(/iPad|iPod|iPhone/),t&&t[0]&&(r[t[0].toLowerCase()]=r.ios)):(t=a.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),t&&(r.mobile=t[0]),/webOS/.test(a)&&(r.mobile="WebOS",t=a.match(/webOS\/([^\s]*);/),t&&t[1]&&(r.webos=n(t[1]))),/ Android/.test(a)&&(r.mobile="Android",t=a.match(/Android ([^\s]*);/),t&&t[1]&&(r.android=n(t[1])))),t=a.match(/Chrome\/([^\s]*)/),t&&t[1]?r.chrome=n(t[1]):(t=a.match(/AdobeAIR\/([^\s]*)/),t&&(r.air=t[0]))),r.webkit||(t=a.match(/Opera[\s\/]([^\s]*)/),t&&t[1]?(r.opera=n(t[1]),t=a.match(/Version\/([^\s]*)/),t&&t[1]&&(r.opera=n(t[1])),t=a.match(/Opera Mini[^;]*/),t&&(r.mobile=t[0])):(t=a.match(/MSIE\s([^;]*)/),t&&t[1]?r.ie=n(t[1]):(t=a.match(/Gecko\/([^\s]*)/),t&&(r.gecko=1,t=a.match(/rv:([^\s\)]*)/),t&&t[1]&&(r.gecko=n(t[1]))))))),r},Fn.env.ua=Fn.env.parseUA(),Fn.isFunction=function(e){return"function"==typeof e||jn.toString.apply(e)===Hn},Fn._IEEnumFix=Fn.env.ua.ie?function(e,t){var n,i,r;for(n=0;n<Kn.length;n+=1)i=Kn[n],r=t[i],Vn.isFunction(r)&&r!=jn[i]&&(e[i]=r)}:function(){},Fn.extend=function(e,t,n){if(!t||!e)throw new Error("extend failed, please check that all dependencies are included.");var i,r=function(){};if(r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==jn.constructor&&(t.prototype.constructor=t),n){for(i in n)Vn.hasOwnProperty(n,i)&&(e.prototype[i]=n[i]);Vn._IEEnumFix(e.prototype,n)}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var n=e.toString(16);if("-"!=n.substr(0,1))n.length%2==1?n="0"+n:n.match(/^[0-7]/)||(n="00"+n);else{var i=n.substr(1),r=i.length;r%2==1?r+=1:n.match(/^[0-7]/)||(r+=2);for(var a="",s=0;r>s;s++)a+="f";var o=new t(a,16),l=o.xor(e).add(t.ONE);n=l.toString(16).replace(/^-/,"")}return n},this.getPEMStringFromHex=function(e,t){var n=CryptoJS.enc.Hex.parse(e),i=CryptoJS.enc.Base64.stringify(n),r=i.replace(/(.{64})/g,"$1\r\n");return r=r.replace(/\r\n$/,""),"-----BEGIN "+t+"-----\r\n"+r+"\r\n-----END "+t+"-----\r\n"}},KJUR.asn1.ASN1Object=function(){var e="";this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+e.length+",v="+this.hV;var t=this.hV.length/2,n=t.toString(16);if(n.length%2==1&&(n="0"+n),128>t)return n;var i=n.length/2;if(i>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);var r=128+i;return r.toString(16)+n},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV
},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(e){KJUR.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(this.s)},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof e&&("undefined"!=typeof e.str?this.setString(e.str):"undefined"!=typeof e.hex&&this.setStringHex(e.hex))},Fn.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){utc=e.getTime()+6e4*e.getTimezoneOffset();var t=new Date(utc);return t},this.formatDate=function(e,t){var n=this.zeroPadding,i=this.localDateToUTC(e),r=String(i.getFullYear());"utc"==t&&(r=r.substr(2,2));var a=n(String(i.getMonth()+1),2),s=n(String(i.getDate()),2),o=n(String(i.getHours()),2),l=n(String(i.getMinutes()),2),u=n(String(i.getSeconds()),2);return r+a+s+o+l+u+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=stohex(this.s)},this.setByDateValue=function(e,t,n,i,r,a){var s=new Date(Date.UTC(e,t-1,n,i,r,a,0));this.setByDate(s)},this.getFreshValueHex=function(){return this.hV}},Fn.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(e){KJUR.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,"undefined"!=typeof e&&"undefined"!=typeof e.array&&(this.asn1Array=e.array)},Fn.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},Fn.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(e){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var n=new t(String(e),10);this.setByBigInteger(n)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof e&&("undefined"!=typeof e.bigint?this.setByBigInteger(e.bigint):"undefined"!=typeof e["int"]?this.setByInteger(e["int"]):"undefined"!=typeof e.hex&&this.setValueHex(e.hex))},Fn.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(e){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(0>e||e>7)throw"unused bits shall be from 0 to 7: u = "+e;var n="0"+e;this.hTLV=null,this.isModified=!0,this.hV=n+t},this.setByBinaryString=function(e){e=e.replace(/0+$/,"");var t=8-e.length%8;8==t&&(t=0);for(var n=0;t>=n;n++)e+="0";for(var i="",n=0;n<e.length-1;n+=8){var r=e.substr(n,8),a=parseInt(r,2).toString(16);1==a.length&&(a="0"+a),i+=a}this.hTLV=null,this.isModified=!0,this.hV="0"+t+i},this.setByBooleanArray=function(e){for(var t="",n=0;n<e.length;n++)t+=1==e[n]?"1":"0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),n=0;e>n;n++)t[n]=!1;return t},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof e&&("undefined"!=typeof e.hex?this.setHexValueIncludingUnusedBits(e.hex):"undefined"!=typeof e.bin?this.setByBinaryString(e.bin):"undefined"!=typeof e.array&&this.setByBooleanArray(e.array))},Fn.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(e){KJUR.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},Fn.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Fn.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(e){var n=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},i=function(e){var i="",r=new t(e,10),a=r.toString(2),s=7-a.length%7;7==s&&(s=0);for(var o="",l=0;s>l;l++)o+="0";a=o+a;for(var l=0;l<a.length-1;l+=7){var u=a.substr(l,7);l!=a.length-7&&(u="1"+u),i+=n(parseInt(u,2))}return i};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var t="",r=e.split("."),a=40*parseInt(r[0])+parseInt(r[1]);t+=n(a),r.splice(0,2);for(var s=0;s<r.length;s++)t+=i(r[s]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){if("undefined"==typeof KJUR.asn1.x509.OID.name2oidList[e])throw"DERObjectIdentifier oidName undefined: "+e;var t=KJUR.asn1.x509.OID.name2oidList[e];this.setValueOidString(t)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof e&&("undefined"!=typeof e.oid?this.setValueOidString(e.oid):"undefined"!=typeof e.hex?this.setValueHex(e.hex):"undefined"!=typeof e.name&&this.setValueName(e.name))},Fn.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(e){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},Fn.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(e){KJUR.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},Fn.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(e){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},Fn.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(e){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},Fn.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(e){KJUR.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},Fn.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(e){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},"undefined"!=typeof e&&("undefined"!=typeof e.str?this.setString(e.str):"undefined"!=typeof e.hex?this.setStringHex(e.hex):"undefined"!=typeof e.date&&this.setByDate(e.date))},Fn.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(e){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},"undefined"!=typeof e&&("undefined"!=typeof e.str?this.setString(e.str):"undefined"!=typeof e.hex?this.setStringHex(e.hex):"undefined"!=typeof e.date&&this.setByDate(e.date))},Fn.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(e){KJUR.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++){var n=this.asn1Array[t];e+=n.getEncodedHex()}return this.hV=e,this.hV}},Fn.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(e){KJUR.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var n=this.asn1Array[t];e.push(n.getEncodedHex())}return e.sort(),this.hV=e.join(""),this.hV}},Fn.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(e){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,n){this.hT=t,this.isExplicit=e,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof e&&("undefined"!=typeof e.tag&&(this.hT=e.tag),"undefined"!=typeof e.explicit&&(this.isExplicit=e.explicit),"undefined"!=typeof e.obj&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},Fn.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object),function(e){"use strict";var t,n={};n.decode=function(n){var i;if(t===e){var r="0123456789ABCDEF",a=" \f\n\r	\xa0\u2028\u2029";for(t=[],i=0;16>i;++i)t[r.charAt(i)]=i;for(r=r.toLowerCase(),i=10;16>i;++i)t[r.charAt(i)]=i;for(i=0;i<a.length;++i)t[a.charAt(i)]=-1}var s=[],o=0,l=0;for(i=0;i<n.length;++i){var u=n.charAt(i);if("="==u)break;if(u=t[u],-1!=u){if(u===e)throw"Illegal character at offset "+i;o|=u,++l>=2?(s[s.length]=o,o=0,l=0):o<<=4}}if(l)throw"Hex encoding incomplete: 4 bits missing";return s},window.Hex=n}(),function(e){"use strict";var t,n={};n.decode=function(n){var i;if(t===e){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="= \f\n\r	\xa0\u2028\u2029";for(t=[],i=0;64>i;++i)t[r.charAt(i)]=i;for(i=0;i<a.length;++i)t[a.charAt(i)]=-1}var s=[],o=0,l=0;for(i=0;i<n.length;++i){var u=n.charAt(i);if("="==u)break;if(u=t[u],-1!=u){if(u===e)throw"Illegal character at offset "+i;o|=u,++l>=4?(s[s.length]=o>>16,s[s.length]=o>>8&255,s[s.length]=255&o,o=0,l=0):o<<=6}}switch(l){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";case 2:s[s.length]=o>>10;break;case 3:s[s.length]=o>>16,s[s.length]=o>>8&255}return s},n.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,n.unarmor=function(e){var t=n.re.exec(e);if(t)if(t[1])e=t[1];else{if(!t[2])throw"RegExp out of sync";e=t[2]}return n.decode(e)},window.Base64=n}(),function(e){"use strict";function t(e,n){e instanceof t?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=n)}function n(e,t,n,i,r){this.stream=e,this.header=t,this.length=n,this.tag=i,this.sub=r}var i=100,r="\u2026",a={tag:function(e,t){var n=document.createElement(e);return n.className=t,n},text:function(e){return document.createTextNode(e)}};t.prototype.get=function(t){if(t===e&&(t=this.pos++),t>=this.enc.length)throw"Requesting byte offset "+t+" on a stream of length "+this.enc.length;return this.enc[t]},t.prototype.hexDigits="0123456789ABCDEF",t.prototype.hexByte=function(e){return this.hexDigits.charAt(e>>4&15)+this.hexDigits.charAt(15&e)},t.prototype.hexDump=function(e,t,n){for(var i="",r=e;t>r;++r)if(i+=this.hexByte(this.get(r)),n!==!0)switch(15&r){case 7:i+="  ";break;case 15:i+="\n";break;default:i+=" "}return i},t.prototype.parseStringISO=function(e,t){for(var n="",i=e;t>i;++i)n+=String.fromCharCode(this.get(i));return n},t.prototype.parseStringUTF=function(e,t){for(var n="",i=e;t>i;){var r=this.get(i++);n+=String.fromCharCode(128>r?r:r>191&&224>r?(31&r)<<6|63&this.get(i++):(15&r)<<12|(63&this.get(i++))<<6|63&this.get(i++))}return n},t.prototype.parseStringBMP=function(e,t){for(var n="",i=e;t>i;i+=2){var r=this.get(i),a=this.get(i+1);n+=String.fromCharCode((r<<8)+a)}return n},t.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,t.prototype.parseTime=function(e,t){var n=this.parseStringISO(e,t),i=this.reTime.exec(n);return i?(n=i[1]+"-"+i[2]+"-"+i[3]+" "+i[4],i[5]&&(n+=":"+i[5],i[6]&&(n+=":"+i[6],i[7]&&(n+="."+i[7]))),i[8]&&(n+=" UTC","Z"!=i[8]&&(n+=i[8],i[9]&&(n+=":"+i[9]))),n):"Unrecognized time: "+n},t.prototype.parseInteger=function(e,t){var n=t-e;if(n>4){n<<=3;var i=this.get(e);if(0===i)n-=8;else for(;128>i;)i<<=1,--n;return"("+n+" bit)"}for(var r=0,a=e;t>a;++a)r=r<<8|this.get(a);return r},t.prototype.parseBitString=function(e,t){var n=this.get(e),i=(t-e-1<<3)-n,r="("+i+" bit)";if(20>=i){var a=n;r+=" ";for(var s=t-1;s>e;--s){for(var o=this.get(s),l=a;8>l;++l)r+=o>>l&1?"1":"0";a=0}}return r},t.prototype.parseOctetString=function(e,t){var n=t-e,a="("+n+" byte) ";n>i&&(t=e+i);for(var s=e;t>s;++s)a+=this.hexByte(this.get(s));return n>i&&(a+=r),a},t.prototype.parseOID=function(e,t){for(var n="",i=0,r=0,a=e;t>a;++a){var s=this.get(a);if(i=i<<7|127&s,r+=7,!(128&s)){if(""===n){var o=80>i?40>i?0:1:2;n=o+"."+(i-40*o)}else n+="."+(r>=31?"bigint":i);i=r=0}}return n},n.prototype.typeName=function(){if(this.tag===e)return"unknown";var t=this.tag>>6,n=(this.tag>>5&1,31&this.tag);switch(t){case 0:switch(n){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+n.toString(16)}case 1:return"Application_"+n.toString(16);case 2:return"["+n+"]";case 3:return"Private_"+n.toString(16)}},n.prototype.reSeemsASCII=/^[ -~]+$/,n.prototype.content=function(){if(this.tag===e)return null;var t=this.tag>>6,n=31&this.tag,a=this.posContent(),s=Math.abs(this.length);if(0!==t){if(null!==this.sub)return"("+this.sub.length+" elem)";var o=this.stream.parseStringISO(a,a+Math.min(s,i));return this.reSeemsASCII.test(o)?o.substring(0,2*i)+(o.length>2*i?r:""):this.stream.parseOctetString(a,a+s)}switch(n){case 1:return 0===this.stream.get(a)?"false":"true";case 2:return this.stream.parseInteger(a,a+s);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(a,a+s);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(a,a+s);case 6:return this.stream.parseOID(a,a+s);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(a,a+s);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(a,a+s);case 30:return this.stream.parseStringBMP(a,a+s);case 23:case 24:return this.stream.parseTime(a,a+s)}return null},n.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},n.prototype.print=function(t){if(t===e&&(t=""),document.writeln(t+this),null!==this.sub){t+="  ";for(var n=0,i=this.sub.length;i>n;++n)this.sub[n].print(t)}},n.prototype.toPrettyString=function(t){t===e&&(t="");var n=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(n+="+"),n+=this.length,32&this.tag?n+=" (constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(n+=" (encapsulates)"),n+="\n",null!==this.sub){t+="  ";for(var i=0,r=this.sub.length;r>i;++i)n+=this.sub[i].toPrettyString(t)}return n},n.prototype.toDOM=function(){var e=a.tag("div","node");e.asn1=this;var t=a.tag("div","head"),n=this.typeName().replace(/_/g," ");t.innerHTML=n;var i=this.content();if(null!==i){i=String(i).replace(/</g,"&lt;");var r=a.tag("span","preview");r.appendChild(a.text(i)),t.appendChild(r)}e.appendChild(t),this.node=e,this.head=t;var s=a.tag("div","value");if(n="Offset: "+this.stream.pos+"<br/>",n+="Length: "+this.header+"+",n+=this.length>=0?this.length:-this.length+" (undefined)",32&this.tag?n+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(n+="<br/>(encapsulates)"),null!==i&&(n+="<br/>Value:<br/><b>"+i+"</b>","object"==typeof oids&&6==this.tag)){var o=oids[i];o&&(o.d&&(n+="<br/>"+o.d),o.c&&(n+="<br/>"+o.c),o.w&&(n+="<br/>(warning!)"))}s.innerHTML=n,e.appendChild(s);var l=a.tag("div","sub");if(null!==this.sub)for(var u=0,h=this.sub.length;h>u;++u)l.appendChild(this.sub[u].toDOM());return e.appendChild(l),t.onclick=function(){e.className="node collapsed"==e.className?"node":"node collapsed"},e},n.prototype.posStart=function(){return this.stream.pos},n.prototype.posContent=function(){return this.stream.pos+this.header},n.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},n.prototype.fakeHover=function(e){this.node.className+=" hover",e&&(this.head.className+=" hover")},n.prototype.fakeOut=function(e){var t=/ ?hover/;this.node.className=this.node.className.replace(t,""),e&&(this.head.className=this.head.className.replace(t,""))},n.prototype.toHexDOM_sub=function(e,t,n,i,r){if(!(i>=r)){var s=a.tag("span",t);s.appendChild(a.text(n.hexDump(i,r))),e.appendChild(s)}},n.prototype.toHexDOM=function(t){var n=a.tag("span","hex");if(t===e&&(t=n),this.head.hexNode=n,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},n.asn1=this,n.onmouseover=function(){var e=!t.selected;e&&(t.selected=this.asn1,this.className="hexCurrent"),this.asn1.fakeHover(e)},n.onmouseout=function(){var e=t.selected==this.asn1;this.asn1.fakeOut(e),e&&(t.selected=null,this.className="hex")},this.toHexDOM_sub(n,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(n,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null===this.sub)n.appendChild(a.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var i=this.sub[0],r=this.sub[this.sub.length-1];this.toHexDOM_sub(n,"intro",this.stream,this.posContent(),i.posStart());for(var s=0,o=this.sub.length;o>s;++s)n.appendChild(this.sub[s].toHexDOM(t));this.toHexDOM_sub(n,"outro",this.stream,r.posEnd(),this.posEnd())}return n},n.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},n.decodeLength=function(e){var t=e.get(),n=127&t;if(n==t)return n;if(n>3)throw"Length over 24 bits not supported at position "+(e.pos-1);if(0===n)return-1;t=0;for(var i=0;n>i;++i)t=t<<8|e.get();return t},n.hasContent=function(e,i,r){if(32&e)return!0;if(3>e||e>4)return!1;var a=new t(r);3==e&&a.get();var s=a.get();if(s>>6&1)return!1;try{var o=n.decodeLength(a);return a.pos-r.pos+o==i}catch(l){return!1}},n.decode=function(e){e instanceof t||(e=new t(e,0));var i=new t(e),r=e.get(),a=n.decodeLength(e),s=e.pos-i.pos,o=null;if(n.hasContent(r,a,e)){var l=e.pos;if(3==r&&e.get(),o=[],a>=0){for(var u=l+a;e.pos<u;)o[o.length]=n.decode(e);if(e.pos!=u)throw"Content size is not correct for container starting at offset "+l}else try{for(;;){var h=n.decode(e);if(0===h.tag)break;o[o.length]=h}a=l-e.pos}catch(c){throw"Exception while decoding undefined length content: "+c}}else e.pos+=a;return new n(i,s,a,r,o)},n.test=function(){for(var e=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],i=0,r=e.length;r>i;++i){var a=new t(e[i].value,0),s=n.decodeLength(a);s!=e[i].expected&&document.write("In test["+i+"] expected "+e[i].expected+" got "+s+"\n")}},window.ASN1=n}(),ASN1.prototype.getHexStringValue=function(){var e=this.toHexString(),t=2*this.header,n=2*this.length;return e.substr(t,n)},hn.prototype.parseKey=function(e){try{var t=0,n=0,i=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,r=i.test(e)?Hex.decode(e):Base64.unarmor(e),a=ASN1.decode(r);if(3===a.sub.length&&(a=a.sub[2].sub[0]),9===a.sub.length){t=a.sub[1].getHexStringValue(),this.n=ln(t,16),n=a.sub[2].getHexStringValue(),this.e=parseInt(n,16);var s=a.sub[3].getHexStringValue();this.d=ln(s,16);var o=a.sub[4].getHexStringValue();this.p=ln(o,16);var l=a.sub[5].getHexStringValue();this.q=ln(l,16);var u=a.sub[6].getHexStringValue();this.dmp1=ln(u,16);var h=a.sub[7].getHexStringValue();this.dmq1=ln(h,16);var c=a.sub[8].getHexStringValue();this.coeff=ln(c,16)}else{if(2!==a.sub.length)return!1;var d=a.sub[1],f=d.sub[0];t=f.sub[0].getHexStringValue(),this.n=ln(t,16),n=f.sub[1].getHexStringValue(),this.e=parseInt(n,16)}return!0}catch(p){return!1}},hn.prototype.getPrivateBaseKey=function(){var e={array:[new KJUR.asn1.DERInteger({"int":0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]},t=new KJUR.asn1.DERSequence(e);return t.getEncodedHex()},hn.prototype.getPrivateBaseKeyB64=function(){return bn(this.getPrivateBaseKey())},hn.prototype.getPublicBaseKey=function(){var e={array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]},t=new KJUR.asn1.DERSequence(e);e={array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e})]};var n=new KJUR.asn1.DERSequence(e);e={hex:"00"+n.getEncodedHex()};var i=new KJUR.asn1.DERBitString(e);e={array:[t,i]};var r=new KJUR.asn1.DERSequence(e);return r.getEncodedHex()},hn.prototype.getPublicBaseKeyB64=function(){return bn(this.getPublicBaseKey())},hn.prototype.wordwrap=function(e,t){if(t=t||64,!e)return e;var n="(.{1,"+t+"})( +|$\n?)|(.{1,"+t+"})";return e.match(RegExp(n,"g")).join("\n")},hn.prototype.getPrivateKey=function(){var e="-----BEGIN RSA PRIVATE KEY-----\n";return e+=this.wordwrap(this.getPrivateBaseKeyB64())+"\n",e+="-----END RSA PRIVATE KEY-----"},hn.prototype.getPublicKey=function(){var e="-----BEGIN PUBLIC KEY-----\n";return e+=this.wordwrap(this.getPublicBaseKeyB64())+"\n",e+="-----END PUBLIC KEY-----"},hn.prototype.hasPublicKeyProperty=function(e){return e=e||{},e.hasOwnProperty("n")&&e.hasOwnProperty("e")},hn.prototype.hasPrivateKeyProperty=function(e){return e=e||{},e.hasOwnProperty("n")&&e.hasOwnProperty("e")&&e.hasOwnProperty("d")&&e.hasOwnProperty("p")&&e.hasOwnProperty("q")&&e.hasOwnProperty("dmp1")&&e.hasOwnProperty("dmq1")&&e.hasOwnProperty("coeff")},hn.prototype.parsePropertiesFrom=function(e){this.n=e.n,this.e=e.e,e.hasOwnProperty("d")&&(this.d=e.d,this.p=e.p,this.q=e.q,this.dmp1=e.dmp1,this.dmq1=e.dmq1,this.coeff=e.coeff)};var Jn=function(e){hn.call(this),e&&("string"==typeof e?this.parseKey(e):(this.hasPrivateKeyProperty(e)||this.hasPublicKeyProperty(e))&&this.parsePropertiesFrom(e))};Jn.prototype=new hn,Jn.prototype.constructor=Jn;var zn=function(e){e=e||{},this.default_key_size=parseInt(e.default_key_size)||1024,this.default_public_exponent=e.default_public_exponent||"010001",this.log=e.log||!1,this.key=null};zn.prototype.setKey=function(e){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new Jn(e)},zn.prototype.setPrivateKey=function(e){this.setKey(e)},zn.prototype.setPublicKey=function(e){this.setKey(e)},zn.prototype.decrypt=function(e){try{return this.getKey().decrypt(wn(e))}catch(t){return!1}},zn.prototype.encrypt=function(e){try{return bn(this.getKey().encrypt(e))}catch(t){return!1}},zn.prototype.getKey=function(e){if(!this.key){if(this.key=new Jn,e&&"[object Function]"==={}.toString.call(e))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,e);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},zn.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},zn.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},zn.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},zn.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},zn.version="2.3.1",e.JSEncrypt=zn}),$(document).on("page:load ready",function(){var e=-90;$(".flash").length>0&&($(".flash").on("click",function(){$(this).hide("slow")}),setTimeout(function(){$("div.flash.alert.alert-success").length>0&&$(".flash").hide("slow")},15e3)),$("#talkback_command_add").click(function(){$(this).hide(),$("#talkback_command_add_form").removeClass("hide")}),$("#contact_link").click(function(){$("#contact_form").toggle()}),$(".tablesorter").length>0&&$(".tablesorter").tablesorter(),$("#userlogin_js").val("6H2W6QYUAJT1Q8EB"),$("input").not(".maxlength_exempt").attr("maxlength","80"),setTimeout(function(){if(""!==window.location.hash){var t=$(window.location.hash).offset().top+e;$(document).scrollTop(t)}},150)});